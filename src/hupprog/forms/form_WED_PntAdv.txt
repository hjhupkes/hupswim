Version =20
VersionRequired =20
Checksum =-1599622114
Begin Form
    ControlBox = NotDefault
    AutoCenter = NotDefault
    NavigationButtons = NotDefault
    ScrollBars =2
    BorderStyle =1
    GridX =15
    GridY =15
    Width =11376
    ItemSuffix =80
    Left =975
    Top =1965
    Right =13515
    Bottom =6690
    AfterInsert ="[Event Procedure]"
    RecSrcDt = Begin
        0xd47756cb3d5fe340
    End
    RecordSource ="SELECT DISTINCTROW dtgPuntentellingDefs.* FROM dtgPuntentellingDefs WHERE (((dtg"
        "PuntentellingDefs.PTG_Wedstrijdnummer)=waarde())) ORDER BY dtgPuntentellingDefs."
        "PTG_OrderID;"
    Caption ="Programma"
    OnOpen ="[Event Procedure]"
    PrtMip = Begin
        0xa0050000a0050000a0050000a005000000000000201c0000e010000001000000 ,
        0x010000006801000000000000a10700000100000001000000
    End
    PrtDevMode = Begin
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x01042a019c005c0a134700000100090000000000640001000700580201000100 ,
        0x5802010000004134000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000054070000 ,
        0x5052495600200000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000001800000000001027 ,
        0x1027102700001027000000000000000034a20a000000000000000100ff000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000050001000100000000000000 ,
        0x0100000001006cd8000000000000000000000000000000000000000000010000 ,
        0x000064000100bb02880400000000000000000000000000000000000000000000 ,
        0x00000000000000000000000006000000f5ffffff000000000000000000000000 ,
        0x00000000000000010000000041007200690061006c0000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x00000000000000000000000000000000ffffff00000001000000000000000000 ,
        0x0100000000000000010000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000700070000000000020000000100000005000000 ,
        0x0001ffff00000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x00000000000000000000000009000000fffffffffefffffffefffffffeffffff ,
        0xfefffffffefffffffefffffffefffffffefffffffefffffffefffffffeffffff ,
        0xfefffffffefffffffefffffffefffffffefffffffefffffffefffffffeffffff ,
        0xfeffffff09000000ffffffff0307090001000000000000000000000005000000 ,
        0x000000000000000007000000010000000000454e474c49534800000000000000 ,
        0x000042005200530050004c003000310041002e00450058004500000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x00004200520052004200410054004f004d005f00310032003300300000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x00006f00700074005f0031003200330030002e0069006e006900000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x000063006f0070005f0031003200330030002e0069006e006900000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x000048004c0031003200330069006e0069002e00640061007400000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x000048004c003100320033006400650066002e00640061007400000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x000000000000000000000000000000000000000042005200530050004c003000 ,
        0x310041002e004500580045000000000000000000000000000000000000000000 ,
        0x00000000000000000000000000000000000000000400e4030000000001000000 ,
        0x000000000100ffff000000000e01000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000c60088000000640000000000010100000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x00000000000000000000000000000000000000000000000006000000f5ffffff ,
        0x0000000000000000000000000000000000000001000000004100720069006100 ,
        0x6c00000000000000000000000000000000000000000000000000000000000000 ,
        0x00000000000000000000000000000000000000000000000000000000ffffff00 ,
        0x0100000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x00000000000000000000000000000000000000000000000000000000ffffffff ,
        0x6400000000000000000000800000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000100000000000000454f5343
    End
    PrtDevNames = Begin
        0x08001f0036000100000000000000000000000000000000000000000000000000 ,
        0x000000000000000000000000000000000000000000004c5054313a00
    End
    OnActivate ="[Event Procedure]"
    Begin
        Begin Label
            TextAlign =3
            FontWeight =700
        End
        Begin CommandButton
            TextFontFamily =2
            Width =1701
            Height =283
        End
        Begin OptionButton
            AddColon = NotDefault
            SpecialEffect =2
            LabelAlign =3
            Width =187
            Height =187
            LabelX =-236
        End
        Begin CheckBox
            AddColon = NotDefault
            SpecialEffect =2
            LabelAlign =3
            Width =187
            Height =187
            LabelX =-236
        End
        Begin TextBox
            LabelAlign =3
            Width =1701
            LabelX =-236
        End
        Begin ListBox
            LabelAlign =3
            Width =1701
            Height =1417
            LabelX =-236
        End
        Begin ComboBox
            LabelAlign =3
            Width =1701
            LabelX =-236
        End
        Begin FormHeader
            Height =360
            BackColor =16776960
            Name ="FormHeader1"
            Begin
                Begin Label
                    OverlapFlags =85
                    TextAlign =1
                    Left =718
                    Top =120
                    Width =1080
                    Height =240
                    Name ="Label51"
                    Caption ="Korte Naam"
                End
                Begin Label
                    OverlapFlags =85
                    TextAlign =1
                    Left =2494
                    Top =113
                    Width =1125
                    Height =240
                    Name ="Label53"
                    Caption ="Beschrijving"
                End
                Begin Label
                    OverlapFlags =85
                    TextAlign =1
                    Left =38
                    Top =113
                    Width =570
                    Height =240
                    Name ="Label64"
                    Caption ="Volg."
                End
                Begin Label
                    OverlapFlags =85
                    TextAlign =1
                    Left =4686
                    Top =113
                    Width =1200
                    Height =240
                    Name ="Combo69_Label"
                    Caption ="Type telling"
                End
                Begin Label
                    OverlapFlags =85
                    Left =6916
                    Top =113
                    Width =2700
                    Height =240
                    Name ="Label72"
                    Caption ="Gehele meerdaagse wedstrijd: "
                End
            End
        End
        Begin Section
            Height =284
            BackColor =16776960
            Name ="Detail0"
            Begin
                Begin CommandButton
                    Visible = NotDefault
                    TabStop = NotDefault
                    OverlapFlags =85
                    Left =8881
                    Width =291
                    Height =284
                    TabIndex =3
                    Name ="btnDown"
                    Caption ="btnDown"
                    OnClick ="[Event Procedure]"
                    PictureData = Begin
                        0x2800000010000000100000000100040000000000800000000000000000000000 ,
                        0x0000000000000000000000000000800000800000008080008000000080008000 ,
                        0x8080000080808000c0c0c0000000ff00c0c0c00000ffff00ff000000c0c0c000 ,
                        0xffff0000ffffff00dadadadadadadadaadadadadadadadaddadadadadadadada ,
                        0xadadada4adadadaddadada444adadadaadada44444adadaddada4444444adada ,
                        0xada444444444adadda44444444444adaadadad444dadadaddadada444adadada ,
                        0xadadad444dadadaddadada444adadadaadadad444dadadaddadada444adadada ,
                        0xadadadadadadadad
                    End
                    ObjectPalette = Begin
                        0x0003100000000000800000000080000080800000000080008000800000808000 ,
                        0x80808000c0c0c000ff000000c0c0c000ffff00000000ff00c0c0c00000ffff00 ,
                        0xffffff0000000000
                    End
                End
                Begin TextBox
                    OverlapFlags =85
                    TextAlign =1
                    Left =720
                    Height =284
                    TabIndex =1
                    Name ="PTG_ShortName"
                    ControlSource ="PTG_ShortName"
                End
                Begin TextBox
                    OverlapFlags =85
                    TextAlign =1
                    Left =2494
                    Width =2076
                    Height =284
                    TabIndex =2
                    Name ="PTG_Beschrijving"
                    ControlSource ="PTG_Beschrijving"
                End
                Begin TextBox
                    OverlapFlags =85
                    TextAlign =1
                    Left =37
                    Width =531
                    Height =284
                    Name ="PTG_OrderID"
                    ControlSource ="PTG_OrderID"
                    AfterUpdate ="[Event Procedure]"
                    DefaultValue ="=1"
                End
                Begin TextBox
                    Visible = NotDefault
                    OverlapFlags =85
                    Left =8277
                    Width =306
                    TabIndex =4
                    Name ="PTG_Wedstrijdnummer"
                    ControlSource ="PTG_Wedstrijdnummer"
                    DefaultValue ="=waarde()"
                End
                Begin CommandButton
                    Visible = NotDefault
                    TabStop = NotDefault
                    OverlapFlags =85
                    Left =9193
                    Width =291
                    Height =284
                    TabIndex =5
                    Name ="btnUp"
                    Caption ="btnUp"
                    OnClick ="[Event Procedure]"
                    PictureData = Begin
                        0x2800000010000000100000000100040000000000800000000000000000000000 ,
                        0x0000000000000000000000000000800000800000008080008000000080008000 ,
                        0x8080000080808000c0c0c0000000ff00c0c0c00000ffff00ff000000c0c0c000 ,
                        0xffff0000ffffff00dadadadadadadadaadadadadadadadaddadadadadadadada ,
                        0xadadad444dadadaddadada444adadadaadadad444dadadaddadada444adadada ,
                        0xadadad444dadadaddadada444adadadaad44444444444daddad444444444dada ,
                        0xadad4444444dadaddadad44444dadadaadadad444dadadaddadadad4dadadada ,
                        0xadadadadadadadad
                    End
                    ObjectPalette = Begin
                        0x0003100000000000800000000080000080800000000080008000800000808000 ,
                        0x80808000c0c0c000ff000000c0c0c000ffff00000000ff00c0c0c00000ffff00 ,
                        0xffffff0000000000
                    End
                End
                Begin ComboBox
                    RowSourceTypeInt =1
                    OverlapFlags =85
                    ColumnCount =2
                    ListWidth =2268
                    Left =4686
                    Width =2151
                    Height =284
                    TabIndex =6
                    Name ="cmbType"
                    ControlSource ="PTG_Type"
                    RowSourceType ="Value List"
                    RowSource ="\"IND\";\"Individueel\";\"VERSEC\";\"Vereniging: seconden telling\";\"VERPNT\";\""
                        "Vereniging: plaats telling\""
                    ColumnWidths ="0;2116"
                End
                Begin CheckBox
                    SpecialEffect =0
                    OverlapFlags =85
                    Left =7218
                    Top =75
                    TabIndex =7
                    Name ="PTG_EntireMeet"
                    ControlSource ="PTG_EntireMeet"
                End
            End
        End
        Begin FormFooter
            Height =529
            BackColor =16776960
            Name ="FormFooter2"
            Begin
                Begin CommandButton
                    OverlapFlags =85
                    AccessKey =68
                    TextFontFamily =34
                    Left =75
                    Top =113
                    Width =921
                    Height =343
                    FontSize =8
                    FontWeight =400
                    Name ="btnPntDetails"
                    Caption ="-> &Details"
                    OnClick ="[Event Procedure]"
                    FontName ="MS Sans Serif"
                End
                Begin CommandButton
                    OverlapFlags =85
                    TextFontFamily =34
                    Left =2415
                    Top =113
                    Width =951
                    Height =343
                    FontSize =8
                    FontWeight =400
                    TabIndex =2
                    Name ="btnEinduitslag"
                    Caption ="Einduitslag "
                    StatusBarText ="De einduitslag tonen"
                    OnClick ="[Event Procedure]"
                    FontName ="MS Sans Serif"
                    ControlTipText ="De einduitslag tonen"
                End
                Begin CommandButton
                    OverlapFlags =85
                    TextFontFamily =34
                    Left =3436
                    Top =113
                    Width =1251
                    Height =343
                    FontSize =8
                    FontWeight =400
                    TabIndex =3
                    Name ="btnDetails"
                    Caption ="Uitslag: details"
                    StatusBarText ="Gedetailleerde einduitslag tonen"
                    OnClick ="[Event Procedure]"
                    FontName ="MS Sans Serif"
                    ControlTipText ="Gedetailleerde einduitslag tonen"
                End
                Begin CommandButton
                    OverlapFlags =85
                    TextFontFamily =34
                    Left =5555
                    Top =113
                    Width =1746
                    Height =343
                    FontSize =8
                    FontWeight =400
                    TabIndex =4
                    Name ="btnSchattingEinduitslag"
                    Caption ="Schatting: einduitslag bekijken"
                    StatusBarText ="Schatting maken van einduitslag op basis van inschrijftijden"
                    OnClick ="[Event Procedure]"
                    FontName ="MS Sans Serif"
                    ControlTipText ="Schatting maken van einduitslag op basis van inschrijftijden"
                    GUID = Begin
                        0xdef8634a91f7d74fa52e0fc73fffe449
                    End
                End
                Begin CommandButton
                    OverlapFlags =85
                    TextFontFamily =34
                    Left =7367
                    Top =113
                    Width =1386
                    Height =343
                    FontSize =8
                    FontWeight =400
                    TabIndex =5
                    Name ="btnSchattingDetails"
                    Caption ="Schatting: details"
                    StatusBarText ="Schatting maken van einduitslag op basis van inschrijftijden"
                    OnClick ="[Event Procedure]"
                    FontName ="MS Sans Serif"
                    ControlTipText ="Schatting maken van einduitslag op basis van inschrijftijden"
                    GUID = Begin
                        0xd378d25e43b09d4c984f9995f94dd42d
                    End
                End
                Begin CommandButton
                    OverlapFlags =85
                    TextFontFamily =34
                    Left =8882
                    Top =113
                    Width =1311
                    Height =343
                    FontSize =8
                    FontWeight =400
                    TabIndex =6
                    Name ="btnTestEinduitslag"
                    Caption ="Test: einduitslag"
                    StatusBarText ="Puntentelling testen met behulp van inschrijftijden. Inschrijftijden die eindige"
                        "n op 9 hondersten worden gediskwalificeerd."
                    OnClick ="[Event Procedure]"
                    FontName ="MS Sans Serif"
                    ControlTipText ="Puntentelling testen met behulp van inschrijftijden. Inschrijftijden die eindige"
                        "n op 9 hondersten worden gediskwalificeerd."
                    GUID = Begin
                        0x88c39e83dabe504b9caedf0aafdcddfa
                    End
                End
                Begin CommandButton
                    OverlapFlags =85
                    TextFontFamily =34
                    Left =10280
                    Top =113
                    Width =1056
                    Height =343
                    FontSize =8
                    FontWeight =400
                    TabIndex =7
                    Name ="btnTestDetails"
                    Caption ="Test: details"
                    StatusBarText ="Puntentelling testen met behulp van inschrijftijden. Inschrijftijden die eindige"
                        "n op 9 hondersten worden gediskwalificeerd."
                    OnClick ="[Event Procedure]"
                    FontName ="MS Sans Serif"
                    ControlTipText ="Puntentelling testen met behulp van inschrijftijden. Inschrijftijden die eindige"
                        "n op 9 hondersten worden gediskwalificeerd."
                    GUID = Begin
                        0x1710df1cfccd4544bf3631aab2911fd3
                    End
                End
                Begin CommandButton
                    OverlapFlags =85
                    TextFontFamily =34
                    Left =1096
                    Top =113
                    Width =921
                    Height =343
                    FontSize =8
                    FontWeight =400
                    TabIndex =1
                    Name ="btnDuplicate"
                    Caption ="Dupliceer"
                    StatusBarText ="Geselecteerde puntentelling dupliceren"
                    OnClick ="[Event Procedure]"
                    FontName ="MS Sans Serif"
                    ShortcutMenuBar ="Geselecteerde puntentelling dupliceren"
                    GUID = Begin
                        0x675a3c664614784dbde5f510f130168e
                    End
                End
            End
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Compare Database   'Use database order for string comparisons
Option Explicit



Private Sub handleView(rptOpenMode As Integer, isEindUitslag As Boolean, pntCalcMode As Integer)
On Error GoTo fout
If Nz(Me.PTG_ShortName) <> "" And Nz(Me.PTG_OrderID) > 0 And Nz(Me.cmbType) <> "" Then
  Dim pntWedNr As Long
  Dim pntOrderID As Long
  Dim pntType As String
  
  pntWedNr = waarde()
  pntOrderID = Nz(Me.PTG_OrderID)
  pntType = Nz(Me.cmbType)
  
  If Not pntCalc(pntWedNr, pntOrderID, pntCalcMode) Then
    Exit Sub
  End If
  
  Dim rptName As String
  If (pntType = PNT_TYPE_IND) Then
    rptName = REP_PNT_IND
  Else
    rptName = REP_PNT_VER
    If (isEindUitslag) Then
      If Not rxpSetVerPntUitslagOptions("", "", "", True, "") Then
        Exit Sub
      End If
    Else
      If Not rxpSetVerPntUitslagOptions("", "", "", False, "") Then
        Exit Sub
      End If
    End If
  End If
  
  If Not rptHandleDefault(rptName, rptOpenMode, 1, -1, False, "") Then
    Exit Sub
  End If
  
End If


Exit Sub
fout:
MsgBox Err & " handleView" & vbCrLf & Error$, 16
Exit Sub
End Sub



Private Sub btnDetails_Click()
On Error Resume Next
DoCmd.DoMenuItem A_FORMBAR, A_FILE, A_SAVERECORD, , A_MENU_VER20
handleView RPT_MODE_PREVIEW, False, PNT_CALC_MODE_RESULT
End Sub

Private Sub btnDuplicate_Click()
On Error Resume Next

If Nz(Me.PTG_ShortName) <> "" And Nz(Me.PTG_OrderID) > 0 And Nz(Me.cmbType) <> "" Then
  Dim lPntID As Long
  lPntID = Nz(Me.PTG_OrderID)
  Dim lWedNr As Long
  lWedNr = Nz([PTG_Wedstrijdnummer])
  
  If (lWedNr > 0) Then
    If (MsgBox("Puntentelling: " & vbCrLf & Nz(Me.PTG_ShortName) & vbCrLf & "dupliceren?", vbOKCancel + vbQuestion) = vbCancel) Then
      Exit Sub
    End If
    
    Dim lTgtID As Long
    lTgtID = Nz(DMax("ptg_orderID", "dtgPuntentellingDefs", "ptg_wedstrijdnummer=" & lWedNr), 0) + 1
    
    If Not pntDuplicate(lWedNr, lPntID, lTgtID) Then
      Exit Sub
    End If
    
    Me.Requery
    
    
  End If
End If
  



End Sub

Private Sub btnEinduitslag_Click()
On Error Resume Next
DoCmd.DoMenuItem A_FORMBAR, A_FILE, A_SAVERECORD, , A_MENU_VER20
handleView RPT_MODE_PREVIEW, True, PNT_CALC_MODE_RESULT
End Sub

Private Sub btnSchattingDetails_Click()
On Error Resume Next
DoCmd.DoMenuItem A_FORMBAR, A_FILE, A_SAVERECORD, , A_MENU_VER20
handleView RPT_MODE_PREVIEW, False, PNT_CALC_MODE_ESTIMATE
End Sub

Private Sub btnSchattingEinduitslag_Click()
On Error Resume Next
DoCmd.DoMenuItem A_FORMBAR, A_FILE, A_SAVERECORD, , A_MENU_VER20
handleView RPT_MODE_PREVIEW, True, PNT_CALC_MODE_ESTIMATE
End Sub

Private Sub btnTestDetails_Click()
On Error Resume Next
DoCmd.DoMenuItem A_FORMBAR, A_FILE, A_SAVERECORD, , A_MENU_VER20
handleView RPT_MODE_PREVIEW, False, PNT_CALC_MODE_TEST
End Sub

Private Sub btnTestEinduitslag_Click()
On Error Resume Next
DoCmd.DoMenuItem A_FORMBAR, A_FILE, A_SAVERECORD, , A_MENU_VER20
handleView RPT_MODE_PREVIEW, True, PNT_CALC_MODE_TEST
End Sub

Private Sub btnPntDetails_Click()
On Error Resume Next
DoCmd.DoMenuItem A_FORMBAR, A_FILE, A_SAVERECORD, , A_MENU_VER20

If Nz(Me.PTG_ShortName) <> "" And Nz(Me.PTG_OrderID) > 0 And Nz(Me.cmbType) <> "" Then
  DoCmd.OpenForm "PNT_Master"
End If
End Sub

Private Sub Form_Activate()
On Error Resume Next
Me.OrderBy = ""
    

End Sub

Private Sub Form_AfterInsert()
On Error Resume Next
PTG_OrderID_AfterUpdate
End Sub

Private Sub Form_Open(Cancel As Integer)
On Error Resume Next
setBackground Me
End Sub

Private Sub PTG_OrderID_AfterUpdate()
On Error Resume Next
Me.PTG_OrderID.DefaultValue = CStr(CInt(val(Nz(Me.PTG_OrderID.value))) + 1)
End Sub


Private Sub btnDown_Click()
On Error Resume Next
moveItem 1
End Sub

Private Sub btnUp_Click()
On Error Resume Next
moveItem -1
End Sub
Private Sub moveItem(direction As Integer)
On Error GoTo fout
'sep: 2008; do not use this option; the associated buttons have been hidden.
'the triangle: dtgPuntentellingCats -> dtgPuntentellingCatOnds <- dtgPuntentelingOnd does not allow cascading update

DoCmd.DoMenuItem A_FORMBAR, A_FILE, A_SAVERECORD, , A_MENU_VER20

If Nz([PTG_ShortName]) = "" Then
  Exit Sub
End If

Dim curOrder As Integer
curOrder = Nz(Me.PTG_OrderID)

Dim newOrder As Integer
newOrder = curOrder + direction

If (curOrder > 0) Then
  Me.RecordsetClone.FindFirst "[PTG_OrderID] = " & newOrder
  If (Not Me.RecordsetClone.NoMatch) Then
    Me.RecordsetClone.Edit
    Me.RecordsetClone("PTG_OrderID") = -999
    Me.RecordsetClone.Update
    Me.PTG_OrderID = newOrder
    DoCmd.DoMenuItem A_FORMBAR, A_FILE, A_SAVERECORD, , A_MENU_VER20
    Me.RecordsetClone.Edit
    Me.RecordsetClone("PTG_OrderID") = curOrder
    Me.RecordsetClone.Update
  End If
End If

Dim tpB
tpB = Me.Bookmark
Me.Requery
Me.Bookmark = tpB
Exit Sub
fout:
If (Err = 3159) Then Resume Next 'invalid bookmark
If (Err = 3021) Then Resume Next
MsgBox Err & " moveItem" & vbCrLf & Error$, 16
Exit Sub
End Sub