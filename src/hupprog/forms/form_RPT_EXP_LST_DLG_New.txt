Version =20
VersionRequired =20
Checksum =2083327839
Begin Form
    AllowFilters = NotDefault
    RecordSelectors = NotDefault
    MaxButton = NotDefault
    MinButton = NotDefault
    AutoCenter = NotDefault
    NavigationButtons = NotDefault
    AllowDeletions = NotDefault
    DividingLines = NotDefault
    AllowAdditions = NotDefault
    DefaultView =0
    ScrollBars =0
    BorderStyle =3
    PictureAlignment =2
    DatasheetGridlinesBehavior =3
    GridY =10
    Width =5745
    DatasheetFontHeight =10
    ItemSuffix =39
    Left =1710
    Top =120
    Right =8895
    Bottom =5670
    DatasheetGridlinesColor =12632256
    RecSrcDt = Begin
        0x9ff7c5f8d21ae340
    End
    Caption ="Nieuwe export lijst aanmaken"
    DatasheetFontName ="Arial"
    PrtMip = Begin
        0xa0050000a0050000a0050000a005000000000000201c0000e010000001000000 ,
        0x010000006801000000000000a10700000100000001000000
    End
    PrtDevMode = Begin
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x01042a019c005c0a53ef80010100010000000000640001000f00580202000100 ,
        0x5802030001004134000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000054070000 ,
        0x5052495600200000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000001800000000001027 ,
        0x1027102700001027000000000000000034a20a000000000000000100ff000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000050001000100000000000000 ,
        0x0100000001006cd8000000000000000000000000000000000000000000010000 ,
        0x000064000100bb02880400000000000000000000000000000000000000000000 ,
        0x00000000000000000000000006000000f5ffffff000000000000000000000000 ,
        0x00000000000000010000000041007200690061006c0000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x00000000000000000000000000000000ffffff00000001000000000000000000 ,
        0x0100000000000000010000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000700070000000000020000000100000005000000 ,
        0x0001ffff00000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x00000000000000000000000009000000fffffffffefffffffefffffffeffffff ,
        0xfefffffffefffffffefffffffefffffffefffffffefffffffefffffffeffffff ,
        0xfefffffffefffffffefffffffefffffffefffffffefffffffefffffffeffffff ,
        0xfeffffff09000000ffffffff0307090001000000000000000000000005000000 ,
        0x000000000000000007000000010000000000454e474c49534800000000000000 ,
        0x000042005200530050004c003000310041002e00450058004500000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x00004200520052004200410054004f004d005f00310032003300300000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x00006f00700074005f0031003200330030002e0069006e006900000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x000063006f0070005f0031003200330030002e0069006e006900000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x000048004c0031003200330069006e0069002e00640061007400000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x000048004c003100320033006400650066002e00640061007400000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x000000000000000000000000000000000000000042005200530050004c003000 ,
        0x310041002e004500580045000000000000000000000000000000000000000000 ,
        0x00000000000000000000000000000000000000000400e4030000000001000000 ,
        0x000000000100ffff000000000e01000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000c60088000000640000000000010100000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x00000000000000000000000000000000000000000000000006000000f5ffffff ,
        0x0000000000000000000000000000000000000001000000004100720069006100 ,
        0x6c00000000000000000000000000000000000000000000000000000000000000 ,
        0x00000000000000000000000000000000000000000000000000000000ffffff00 ,
        0x0100000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x00000000000000000000000000000000000000000000000000000000ffffffff ,
        0x6400000000000000000000800000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000100000000000000454f5343
    End
    PrtDevNames = Begin
        0x08001f0036000100000000000000000000000000000000000000000000000000 ,
        0x000000000000000000000000000000000000000000004c5054313a00
    End
    OnLoad ="[Event Procedure]"
    Begin
        Begin Label
            BackStyle =0
        End
        Begin CommandButton
            Width =1701
            Height =283
            FontSize =8
            FontWeight =400
            ForeColor =-2147483630
            FontName ="MS Sans Serif"
        End
        Begin OptionButton
            SpecialEffect =2
            LabelX =230
            LabelY =-30
        End
        Begin CheckBox
            SpecialEffect =2
            LabelX =230
            LabelY =-30
        End
        Begin OptionGroup
            SpecialEffect =3
            Width =1701
            Height =1701
        End
        Begin TextBox
            FELineBreak = NotDefault
            SpecialEffect =2
            OldBorderStyle =0
            Width =1701
            LabelX =-1701
            FontName ="Tahoma"
            AsianLineBreak =255
        End
        Begin ComboBox
            SpecialEffect =2
            Width =1701
            LabelX =-1701
            FontName ="Tahoma"
        End
        Begin FormHeader
            Height =453
            BackColor =-2147483633
            Name ="FormHeader"
            Begin
                Begin Label
                    OverlapFlags =85
                    TextAlign =2
                    Left =-60
                    Top =60
                    Width =5805
                    Height =285
                    FontSize =10
                    FontWeight =700
                    Name ="Label0"
                    Caption ="Nieuwe export lijst aanmaken"
                End
            End
        End
        Begin Section
            Height =3798
            BackColor =-2147483633
            Name ="Detail"
            Begin
                Begin OptionGroup
                    SpecialEffect =0
                    OverlapFlags =93
                    Left =132
                    Top =1204
                    Width =5499
                    Height =2479
                    TabIndex =1
                    Name ="optAction"
                    AfterUpdate ="[Event Procedure]"
                    DefaultValue ="1"
                    GUID = Begin
                        0xc2483bce9a5cab49846ef3ce43b79a9c
                    End
                    Begin
                        Begin Label
                            BackStyle =1
                            OverlapFlags =85
                            Left =120
                            Top =915
                            Width =2460
                            Height =240
                            BackColor =-2147483633
                            Name ="Label22"
                            Caption ="Wat wilt u doen: "
                            GUID = Begin
                                0x6a6c3bc0f4fd3844b2cff43a5fce9cd3
                            End
                        End
                        Begin OptionButton
                            SpecialEffect =0
                            OverlapFlags =87
                            Left =415
                            Top =1405
                            OptionValue =1
                            Name ="optEmpty"
                            GUID = Begin
                                0x9bcb17eaba410d478afd9f2eb59270af
                            End
                            Begin
                                Begin Label
                                    OverlapFlags =87
                                    Left =707
                                    Top =1369
                                    Width =1905
                                    Height =240
                                    Name ="lbSel"
                                    Caption ="Lege nieuwe lijst maken"
                                    GUID = Begin
                                        0x3291a63cda7bc64b87ea4cead3ceb7e7
                                    End
                                End
                            End
                        End
                        Begin OptionButton
                            SpecialEffect =0
                            OverlapFlags =87
                            Left =415
                            Top =1729
                            OptionValue =2
                            Name ="optDuplicate"
                            GUID = Begin
                                0x7c434c1a21314b438764ea426dccf473
                            End
                            Begin
                                Begin Label
                                    OverlapFlags =87
                                    Left =707
                                    Top =1695
                                    Width =2100
                                    Height =240
                                    Name ="lbAll"
                                    Caption ="Bestaande lijst dupliceren"
                                    GUID = Begin
                                        0xd3ffb7e5387c8b41a0defd24005775a6
                                    End
                                End
                            End
                        End
                        Begin OptionButton
                            SpecialEffect =0
                            OverlapFlags =87
                            Left =415
                            Top =2551
                            OptionValue =3
                            Name ="optStd"
                            GUID = Begin
                                0xa784ba2b9be9f04d80ac4b2b1108e6cd
                            End
                            Begin
                                Begin Label
                                    OverlapFlags =87
                                    Left =705
                                    Top =2550
                                    Width =2250
                                    Height =240
                                    Name ="Label34"
                                    Caption ="Standaard lijst aanmaken"
                                    GUID = Begin
                                        0xa027c80690f0ba439ef5795d3b6e42ee
                                    End
                                End
                            End
                        End
                    End
                End
                Begin TextBox
                    SpecialEffect =0
                    OverlapFlags =85
                    IMESentenceMode =3
                    Left =113
                    Top =453
                    Width =4086
                    Name ="fldName"
                    GUID = Begin
                        0xf1d148c7954aff4fbbf53a4f1b5ec15a
                    End
                    Begin
                        Begin Label
                            OverlapFlags =85
                            Left =120
                            Top =120
                            Width =2025
                            Height =240
                            Name ="Label30"
                            Caption ="Kies naam voor nieuwe lijst:"
                            GUID = Begin
                                0xdaf6e3e064d44a448107f39b16c617e1
                            End
                        End
                    End
                End
                Begin ComboBox
                    LimitToList = NotDefault
                    SpecialEffect =0
                    OverlapFlags =215
                    IMESentenceMode =3
                    ColumnCount =2
                    ListWidth =3300
                    Left =2715
                    Top =2097
                    Width =2676
                    TabIndex =2
                    ColumnInfo ="\"\";\"\";\"\";\"\";\"10\";\"510\""
                    GUID = Begin
                        0xf05a0b02db762f44822a1f783a54cfa5
                    End
                    Name ="cmbCurList"
                    RowSourceType ="Table/Query"
                    RowSource ="SELECT ro_Id, ro_description FROM [hpoRptExpListObjects] ORDER BY [RO_Order], [R"
                        "O_ID];"
                    ColumnWidths ="0;3301"
                    BaseInfo ="\"SELECT ro_Id, ro_description FROM [hpoRptExpListObjects] ORDER BY [RO_Order], "
                        "[RO_ID];\";\"hpoRptExpListObjects\";\"\";\"ro_Id\";\"ro_description\";\"PrimaryK"
                        "ey\""
                    Begin
                        Begin Label
                            OverlapFlags =215
                            Left =963
                            Top =2100
                            Width =1515
                            Height =240
                            Name ="RO_Description_Label"
                            Caption ="Kies bestaande lijst: "
                            GUID = Begin
                                0x9f2bdac519ba314eb7182c1422de4018
                            End
                        End
                    End
                End
                Begin TextBox
                    SpecialEffect =0
                    OverlapFlags =215
                    IMESentenceMode =3
                    Left =1700
                    Top =2948
                    Width =2721
                    TabIndex =3
                    Name ="fldNewDir"
                    GUID = Begin
                        0x38688d8414d23d4b94400c43028df385
                    End
                    Begin
                        Begin Label
                            OverlapFlags =215
                            Left =793
                            Top =2948
                            Width =795
                            Height =240
                            Name ="Label36"
                            Caption ="Directory: "
                            GUID = Begin
                                0x8db5f09d8a9c7c4e8a91732fa64258c6
                            End
                        End
                    End
                End
                Begin CheckBox
                    SpecialEffect =0
                    OverlapFlags =215
                    Left =793
                    Top =3318
                    TabIndex =4
                    Name ="fldNewMinimal"
                    DefaultValue ="False"
                    GUID = Begin
                        0x6eb3cca41e362443871b60ae3a84b5a8
                    End
                    Begin
                        Begin Label
                            OverlapFlags =247
                            Left =1020
                            Top =3285
                            Width =3165
                            Height =240
                            Name ="Label38"
                            Caption ="Minimale lijst (voor gebruik tijdens wedstrijd) "
                            GUID = Begin
                                0xda93cb553408264c98ab7ebfb95ade73
                            End
                        End
                    End
                End
                Begin CommandButton
                    TabStop = NotDefault
                    OverlapFlags =215
                    Left =4478
                    Top =2948
                    Width =470
                    FontWeight =700
                    TabIndex =5
                    ForeColor =0
                    Name ="btnFindDir"
                    Caption ="- - -"
                    OnClick ="[Event Procedure]"
                    FontName ="System"
                    GUID = Begin
                        0x08960af813a9254bb28b566a8806b5a3
                    End
                End
            End
        End
        Begin FormFooter
            Height =510
            BackColor =-2147483633
            Name ="FormFooter"
            Begin
                Begin CommandButton
                    Cancel = NotDefault
                    OverlapFlags =85
                    Left =165
                    Top =60
                    Width =1020
                    Height =390
                    FontSize =10
                    FontWeight =700
                    Name ="btnCancel"
                    Caption ="Cancel"
                    OnClick ="[Event Procedure]"
                End
                Begin CommandButton
                    OverlapFlags =85
                    AccessKey =79
                    Left =4590
                    Top =60
                    Width =1020
                    Height =390
                    FontSize =10
                    FontWeight =700
                    TabIndex =1
                    Name ="btnOK"
                    Caption ="&OK"
                    OnClick ="[Event Procedure]"
                End
            End
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Compare Database
Option Explicit

Private Sub initView()
On Error Resume Next

Me.cmbCurList.RowSource = "SELECT RO_ID, RO_Description FROM hpoRptExpListObjects where ro_type_id = " & RXL_TYPE_LISTS & _
 " ORDER BY RO_Order, RO_ID;"


End Sub


Private Sub updateView()
On Error Resume Next
Me.cmbCurList.Enabled = (optAction.value = optDuplicate.OptionValue)
Me.fldNewDir.Enabled = (optAction.value = optStd.OptionValue)
Me.fldNewMinimal.Enabled = (optAction.value = optStd.OptionValue)
End Sub


Private Function perform() As Boolean
On Error GoTo fout
perform = False



Dim sNewName As String
Dim blDuplicate As Boolean
Dim lDupObjID As Long
Dim blCreateStandard As Boolean

Dim blNewIsMinimal As Boolean
Dim sNewDir As String

sNewName = Nz(Me.fldName)
blDuplicate = (Nz(Me.optAction.value) = Me.optDuplicate.OptionValue)
lDupObjID = Nz(Me.cmbCurList, -1)
blCreateStandard = (Nz(Me.optAction.value) = Me.optStd.OptionValue)

blNewIsMinimal = Nz(Me.fldNewMinimal)
sNewDir = Nz(Me.fldNewDir)

If (sNewName = "") Then
  Err.Raise 1, , "Kies een naam voor de nieuwe lijst."
End If

If (blDuplicate) Then
  If (lDupObjID < 0) Then
    Err.Raise 1, , "Kies een bestaande lijst om te dupliceren"
  End If
End If

If (blCreateStandard) And (sNewDir = "") Then
  Err.Raise 1, , "Kies een directory"
End If

If (InStr(1, sNewName, "\") > 0) Then
  Err.Raise 1, , "Naam mag geen \ bevatten"
End If

If (Len(sNewName) > 30) Then
  Err.Raise 1, , "Naam is te lang"
End If
  

Dim rs As Recordset
Set rs = CurrentDb().OpenRecordset("hpoRxlNew")

rs.MoveFirst
If rs.EOF Then
  Err.Raise 1, , "Tabel hpoRxlNew is onverwacht leeg"
End If

rs.Edit

  rs("RXLN_NewName") = hzn(sNewName)
  rs("RXLN_CreateStandard") = blCreateStandard
  rs("RXLN_Duplicate") = blDuplicate
  rs("RXLN_Duplicate_OBJ_ID") = lDupObjID
  rs("RXLN_STD_Directory") = hzn(sNewDir)
  rs("RXLN_STD_LiveTiming") = blNewIsMinimal
  rs("RXLN_OK") = True

rs.Update


appCleanRS rs


perform = True
Exit Function
fout:
If (Err = 3021) Then Resume Next
MsgBox Err & " " & Error$, 16
Exit Function

End Function


Private Sub btnCancel_Click()
On Error Resume Next
DoCmd.Close

End Sub

Private Sub btnFindDir_Click()
On Error Resume Next
Dim sDir As String
sDir = GetDir()
If (sDir <> "") Then
  Me.fldNewDir = sDir
End If
End Sub

Private Sub btnOK_Click()
On Error Resume Next


If (perform()) Then
  DoCmd.Close
End If

End Sub



Private Sub Form_Load()
On Error Resume Next
initView
updateView
End Sub

Private Sub optAction_AfterUpdate()
On Error Resume Next
updateView
End Sub