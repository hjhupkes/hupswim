Version =20
VersionRequired =20
Checksum =-1360128534
Begin Form
    PopUp = NotDefault
    Modal = NotDefault
    RecordSelectors = NotDefault
    ControlBox = NotDefault
    AutoCenter = NotDefault
    NavigationButtons = NotDefault
    DefaultView =0
    ScrollBars =0
    BorderStyle =3
    PictureAlignment =2
    DatasheetGridlinesBehavior =3
    GridY =20
    Width =7937
    DatasheetFontHeight =10
    ItemSuffix =44
    Left =5580
    Top =1500
    Right =13515
    Bottom =8130
    DatasheetGridlinesColor =12632256
    RecSrcDt = Begin
        0x065bb075969ee140
    End
    Caption ="Exporteren"
    OnOpen ="[Event Procedure]"
    DatasheetFontName ="Arial"
    OnLoad ="[Event Procedure]"
    Begin
        Begin Label
            BackStyle =0
        End
        Begin CommandButton
            Width =1701
            Height =283
            FontSize =8
            FontWeight =400
            ForeColor =-2147483630
            FontName ="MS Sans Serif"
        End
        Begin OptionButton
            SpecialEffect =2
            LabelX =230
            LabelY =-30
        End
        Begin CheckBox
            SpecialEffect =2
            LabelX =230
            LabelY =-30
        End
        Begin OptionGroup
            SpecialEffect =3
            Width =1701
            Height =1701
        End
        Begin TextBox
            SpecialEffect =2
            OldBorderStyle =0
            Width =1701
            LabelX =-1701
        End
        Begin FormHeader
            Height =566
            BackColor =65280
            Name ="FormHeader"
            Begin
                Begin Label
                    BackStyle =1
                    OverlapFlags =85
                    Left =2948
                    Top =141
                    Width =1410
                    Height =345
                    FontSize =12
                    FontWeight =700
                    BackColor =16776960
                    Name ="Label0"
                    Caption ="Exporteren"
                End
            End
        End
        Begin Section
            Height =5499
            BackColor =65280
            Name ="Detail"
            Begin
                Begin OptionGroup
                    SpecialEffect =0
                    OverlapFlags =93
                    Left =113
                    Top =280
                    Width =5946
                    Height =3506
                    Name ="Type"
                    AfterUpdate ="[Event Procedure]"
                    DefaultValue ="20"
                    Begin
                        Begin Label
                            BackStyle =1
                            OverlapFlags =215
                            Left =113
                            Top =56
                            Width =3585
                            Height =240
                            Name ="Label2"
                            Caption ="Kies het bestandstype waarnaar u wilt exporteren:"
                        End
                        Begin OptionButton
                            SpecialEffect =0
                            OverlapFlags =87
                            Left =226
                            Top =425
                            OptionValue =12
                            Name ="Option26"
                            Begin
                                Begin Label
                                    BackStyle =1
                                    OverlapFlags =247
                                    Left =450
                                    Top =390
                                    Width =1365
                                    Height =240
                                    Name ="Label27"
                                    Caption ="WAS 2005 (XML) "
                                End
                            End
                        End
                        Begin OptionButton
                            SpecialEffect =0
                            OverlapFlags =87
                            Left =225
                            Top =1305
                            OptionValue =20
                            Name ="Option28"
                            Begin
                                Begin Label
                                    BackStyle =1
                                    OverlapFlags =247
                                    Left =455
                                    Top =1275
                                    Width =720
                                    Height =240
                                    BorderColor =4210752
                                    Name ="Label29"
                                    Caption ="Lenex"
                                End
                            End
                        End
                    End
                End
                Begin Label
                    OverlapFlags =85
                    Left =120
                    Top =4989
                    Width =7755
                    Height =450
                    Name ="Label16"
                    Caption ="Indien u een lenex bestand aanmaakt om vervolgens in Hupprog in te lezen, kunt u"
                        " Lenex - uitgebreid aanklikken. Ditzelfde geldt als u het bestand aanmaakt ten b"
                        "ehoeve van andere Hupsoft gebruikers.\015\012\015\012\015\012"
                End
                Begin CheckBox
                    SpecialEffect =0
                    OverlapFlags =215
                    Left =565
                    Top =1639
                    TabIndex =2
                    Name ="blMeet"
                    AfterUpdate ="[Event Procedure]"
                    DefaultValue ="True"
                    Begin
                        Begin Label
                            BackStyle =1
                            OverlapFlags =247
                            Left =794
                            Top =1622
                            Width =2775
                            Height =240
                            Name ="Label30"
                            Caption ="Lenex - Gehele meerdaagse wedstrijd "
                        End
                    End
                End
                Begin CheckBox
                    SpecialEffect =0
                    OverlapFlags =215
                    Left =565
                    Top =1979
                    TabIndex =3
                    Name ="blLenExt"
                    DefaultValue ="True"
                    Begin
                        Begin Label
                            BackStyle =1
                            OverlapFlags =247
                            Left =794
                            Top =1952
                            Width =3300
                            Height =240
                            Name ="Label31"
                            Caption ="Lenex - uitgebreid (voor Hupswim gebruikers) "
                        End
                    End
                End
                Begin CheckBox
                    SpecialEffect =0
                    OverlapFlags =215
                    Left =570
                    Top =3425
                    TabIndex =7
                    Name ="blLenDeelnemers"
                    AfterUpdate ="[Event Procedure]"
                    DefaultValue ="True"
                    Begin
                        Begin Label
                            BackStyle =1
                            OverlapFlags =247
                            Left =799
                            Top =3391
                            Width =2280
                            Height =225
                            Name ="Label32"
                            Caption ="Lenex - Deelnemers exporteren"
                        End
                    End
                End
                Begin CheckBox
                    SpecialEffect =0
                    OverlapFlags =215
                    Left =570
                    Top =3082
                    TabIndex =6
                    Name ="blLenTijden"
                    AfterUpdate ="[Event Procedure]"
                    DefaultValue ="False"
                    Begin
                        Begin Label
                            BackStyle =1
                            OverlapFlags =247
                            Left =799
                            Top =3060
                            Width =1920
                            Height =240
                            Name ="Label34"
                            Caption ="Lenex - Tijden exporteren "
                        End
                    End
                End
                Begin CheckBox
                    SpecialEffect =0
                    OverlapFlags =215
                    Left =565
                    Top =2306
                    TabIndex =4
                    Name ="blLXF"
                    AfterUpdate ="[Event Procedure]"
                    DefaultValue ="True"
                    Begin
                        Begin Label
                            BackStyle =1
                            OverlapFlags =247
                            Left =794
                            Top =2282
                            Width =2805
                            Height =240
                            Name ="Label37"
                            Caption ="Lenex - gezipt bestand (lxf) aanmaken"
                        End
                    End
                End
                Begin TextBox
                    SpecialEffect =0
                    OverlapFlags =215
                    BackStyle =0
                    Left =120
                    Top =4083
                    Width =7701
                    Height =435
                    FontWeight =700
                    TabIndex =8
                    Name ="fName"
                    Begin
                        Begin Label
                            OverlapFlags =93
                            Left =122
                            Top =3855
                            Width =1215
                            Height =240
                            Name ="Label39"
                            Caption ="Bestandsnaam: "
                        End
                    End
                End
                Begin CommandButton
                    OverlapFlags =85
                    AccessKey =87
                    Left =120
                    Top =4564
                    Width =1260
                    Height =360
                    FontSize =10
                    FontWeight =700
                    TabIndex =9
                    Name ="btnWijzig"
                    Caption ="&Wijzig..."
                    OnClick ="[Event Procedure]"
                End
                Begin CheckBox
                    Enabled = NotDefault
                    SpecialEffect =0
                    OverlapFlags =215
                    Left =570
                    Top =737
                    TabIndex =1
                    Name ="blMeetWas"
                    AfterUpdate ="[Event Procedure]"
                    DefaultValue ="True"
                    Begin
                        Begin Label
                            BackStyle =1
                            OverlapFlags =247
                            Left =799
                            Top =720
                            Width =2775
                            Height =240
                            Name ="Label41"
                            Caption ="Was - Gehele meerdaagse wedstrijd "
                        End
                    End
                End
                Begin CheckBox
                    SpecialEffect =0
                    OverlapFlags =215
                    Left =570
                    Top =2634
                    TabIndex =5
                    Name ="blVersion3"
                    DefaultValue ="False"
                    GUID = Begin
                        0x69b4b11e8cd41e4894029ab7d9569d4a
                    End
                    Begin
                        Begin Label
                            BackStyle =1
                            OverlapFlags =247
                            Left =799
                            Top =2610
                            Width =2205
                            Height =240
                            Name ="Label43"
                            Caption ="Lenex - versie 3.0 gebruiken"
                            GUID = Begin
                                0xc868b66164daff4cbc0c1e140ad19367
                            End
                        End
                    End
                End
            End
        End
        Begin FormFooter
            Height =576
            BackColor =65280
            Name ="FormFooter"
            Begin
                Begin CommandButton
                    Default = NotDefault
                    OverlapFlags =85
                    Left =5442
                    Top =56
                    Width =1200
                    Height =405
                    FontSize =10
                    FontWeight =700
                    Name ="btnOK"
                    Caption ="OK"
                    OnClick ="[Event Procedure]"
                End
                Begin CommandButton
                    Cancel = NotDefault
                    OverlapFlags =85
                    Left =144
                    Top =72
                    Width =1200
                    Height =405
                    FontSize =10
                    FontWeight =700
                    TabIndex =1
                    Name ="btnCancel"
                    Caption ="Annuleren"
                    OnClick ="[Event Procedure]"
                End
            End
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Compare Database
Option Explicit

Private Function suggestFExt(blLXF As Boolean, blWas As Boolean) As String
On Error Resume Next
Dim lxfExt As String
If (blWas) Then
  lxfExt = "xml"
ElseIf (blLXF) Then
  lxfExt = "lxf"
Else
  lxfExt = "lef"
End If
suggestFExt = lxfExt
End Function
Private Function suggestFName(blEntireMeetWas As Boolean, blEntireMeetLXF As Boolean, blDlns As Boolean, blTd As Boolean, blLXF As Boolean, blWas As Boolean) As String
On Error GoTo fout
suggestFName = ""

Dim blEntireMeet As Boolean
If (blWas) Then
  blEntireMeet = blEntireMeetWas
Else
  blEntireMeet = blEntireMeetLXF
End If

Dim wedInf As WED_BASIC_INFO
Dim isFnd As Boolean

If Not wedLookup(waarde(), isFnd, wedInf) Then
  Exit Function
End If

If Not isFnd Then
  Exit Function
End If


Dim dActDate As Date, sActDes As String

If (blEntireMeet) Then
  dActDate = wedInf.meetMinDate
  sActDes = wedInf.meetDes
Else
  dActDate = wedInf.date
  sActDes = wedInf.des
End If



Dim fnPrefix As String

  
  'lxfName = dbdir_op() & "\" & fnPrefix & Format(wed_datum(), "dd-mm-yyyy") & ".lef"

If (blTd And Not blWas) Then
  fnPrefix = Format(Nz(dActDate, #1/1/1900#), "yyyy\-mm\-dd") & "=" & GoedTekens(Nz(wedInf.Plaats)) & "-" & GoedTekens(sActDes) & "_uitslag"
ElseIf (blDlns Or blWas) Then
  fnPrefix = Format(Nz(dActDate, #1/1/1900#), "yyyy\-mm\-dd") & "=" & GoedTekens(Nz(ver())) & "-" & GoedTekens(sActDes) & "_inschrijving"
Else
  fnPrefix = Format(Nz(dActDate, #1/1/1900#), "yyyy\-mm\-dd") & "=" & GoedTekens(Nz(wedInf.Plaats)) & "-" & GoedTekens(sActDes) & "_programma"
End If


Dim lxfDir As String, lxfExt As String, lxfName As String
lxfDir = dbdir_op()
lxfExt = suggestFExt(blLXF, blWas)
lxfName = directory_goedmaak(dbdir_op()) & "\" & fnPrefix & "." & lxfExt
 
 
suggestFName = lxfName

Exit Function
fout:
MsgBox Err & " " & Error$, 16
Exit Function
End Function

Private Sub blLenDeelnemers_AfterUpdate()
On Error Resume Next
updateFName
End Sub



Private Sub blLenTijden_AfterUpdate()
On Error Resume Next
updateFName
End Sub

Private Sub blLXF_AfterUpdate()
On Error Resume Next
updateFName
End Sub



Private Sub blMeet_AfterUpdate()
On Error Resume Next
updateFName
End Sub

Private Sub blMeetWas_AfterUpdate()
On Error Resume Next
updateFName
End Sub

Private Sub btnOK_Click()
On Error GoTo fout


Dim expFName As String
expFName = Me.fName

If (expFName = "") Then
  MsgBox "Kies een bestandsnaam.", 16
  Exit Sub
End If

Dim isLx As Boolean
isLx = (Nz(Me.Type) = 20)

Dim isWas As Boolean
isWas = (Nz(Me.Type) = 12)



If (isLx) Then
  
  Dim blDlns As Boolean
  Dim blTd As Boolean
  Dim blLXF As Boolean
  blDlns = Nz(Me.blLenDeelnemers)
  blTd = Nz(Me.blLenTijden)
  blLXF = Nz(Me.blLXF)
  
  
  Dim lxfDir As String, lxfExt As String, lxfName As String
  
  
  lxfDir = extractFilePath(expFName)
  lxfName = extractFileName(expFName)
  
  Dim wednr As Long
  If Me.blMeet And wed_IsMeet() Then
    wednr = wed_MeetMainNr
  Else
    wednr = waarde()
  End If
  
  Dim lxVersion As Long
  lxVersion = LX_VERSION_2
  If (Nz(Me.blVersion3)) Then
    lxVersion = LX_VERSION_3
  End If
   
  If (lenHandleCompleteExportSequence(lxfDir, lxfName, Not Nz(Me.blMeet), wednr, Not (Me.blLenExt), lxVersion, blDlns, blTd)) Then
     DoCmd.Close
  End If
  
  Exit Sub
End If

If (isWas) Then
  
  Dim blWasMeet As Boolean
  blWasMeet = Nz(Me.blMeetWas)
  
  Dim wasWednr As Long
  If blWasMeet And wed_IsMeet() Then
    wasWednr = wed_MeetMainNr
  Else
    wasWednr = waarde()
  End If

  
  If (lenHandleCompleteWasExportSequence(expFName, WAS_FILE_TYPE_DLN, wasWednr, Not blWasMeet)) Then
    DoCmd.Close
  End If
  
  Exit Sub
End If




Exit Sub

fout:
MsgBox Err & " " & Error$, 16
Exit Sub

'debug
On Error GoTo 0
Resume

End Sub

Private Sub btnCancel_Click()
On Error Resume Next
DoCmd.Close
End Sub

Private Sub btnWijzig_Click()
On Error GoTo fout


Dim expFName As String

expFName = Nz(Me.fName)


Dim blDlns As Boolean
Dim blTd As Boolean
Dim blLXF As Boolean
Dim blWas As Boolean
Dim blEntireMeetWas As Boolean
Dim blEntireMeetLx As Boolean


blDlns = Nz(Me.blLenDeelnemers)
blTd = Nz(Me.blLenTijden)
blLXF = Nz(Me.blLXF)

blEntireMeetWas = Nz(Me.blMeetWas)
blEntireMeetLx = Nz(Me.blMeet)

blWas = Nz(Me.Type) <> 20

If Not DirectoryExists(extractFilePath(expFName)) Then
  If Not DirectoryExists(dbdir_op()) Then
    expFName = "c:\" & extractFileName(suggestFName(blEntireMeetWas, blEntireMeetLx, blDlns, blTd, blLXF, blWas))
  Else
    expFName = directory_goedmaak(dbdir_op()) & extractFileName(suggestFName(blEntireMeetWas, blEntireMeetLx, blDlns, blTd, blLXF, blWas))
  End If
End If
  
Dim fExt As String
fExt = suggestFExt(blLXF, blWas)
  
If (fExt = "xml") Then
  If Not fileNamePromptUser(FILE_DLG_SAVE, "Was2005 Inschrijving Exporteren ", "Was2005 bestand(*.xml)|*.xml", expFName, True, True) Then
    Exit Sub
  End If
ElseIf (fExt = "lef") Then
  If Not fileNamePromptUser(FILE_DLG_SAVE, "Lenex bestand aanmaken ", "Lenex (*.lef)|*.lef", expFName, True, True) Then
    Exit Sub
  End If
ElseIf (fExt = "lxf") Then
  If Not fileNamePromptUser(FILE_DLG_SAVE, "Lenex bestand aanmaken ", "Lenex (*.lxf)|*.lxf", expFName, True, True) Then
    Exit Sub
  End If
End If

If (expFName <> "") Then
  If (Right(expFName, 4) <> "." & fExt) Then
    expFName = expFName & "." & fExt
  End If
  Me.fName = expFName
End If


Exit Sub
fout:
MsgBox Err & " " & Error$, 16
End Sub

Private Sub Form_Load()
On Error Resume Next
updateFName

End Sub

Private Sub Form_Open(Cancel As Integer)
On Error Resume Next
setBackground Me
End Sub

Private Sub Type_AfterUpdate()
On Error Resume Next
Dim blLenex As Boolean
blLenex = Nz(Me.Type) = 20

Me.blLenDeelnemers.Enabled = blLenex
Me.blLenTijden.Enabled = blLenex
Me.blMeet.Enabled = blLenex
Me.blLenExt.Enabled = blLenex
Me.blLXF.Enabled = blLenex
Me.blVersion3.Enabled = blLenex

Me.blMeetWas.Enabled = Not blLenex

updateFName

End Sub

Private Sub updateFName()
On Error Resume Next

  Dim blDlns As Boolean
  Dim blTd As Boolean
  Dim blLXF As Boolean
  Dim blWas As Boolean
  
  Dim blEntireMeetWas As Boolean
  Dim blEntireMeetLx As Boolean

  blDlns = Nz(Me.blLenDeelnemers)
  blTd = Nz(Me.blLenTijden)
  blLXF = Nz(Me.blLXF)
  
  blEntireMeetWas = Nz(Me.blMeetWas)
  blEntireMeetLx = Nz(Me.blMeet)

  
  blWas = Nz(Me.Type) <> 20
  
  fName = suggestFName(blEntireMeetWas, blEntireMeetLx, blDlns, blTd, blLXF, blWas)

End Sub