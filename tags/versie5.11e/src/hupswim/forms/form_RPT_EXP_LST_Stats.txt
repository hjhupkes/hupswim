Version =20
VersionRequired =20
Checksum =-1856126643
Begin Form
    AllowFilters = NotDefault
    PopUp = NotDefault
    Modal = NotDefault
    MaxButton = NotDefault
    MinButton = NotDefault
    AutoCenter = NotDefault
    NavigationButtons = NotDefault
    ScrollBars =2
    BorderStyle =1
    PictureAlignment =2
    DatasheetGridlinesBehavior =3
    GridY =10
    Width =10714
    DatasheetFontHeight =10
    ItemSuffix =40
    Left =1245
    Top =2235
    Right =7065
    Bottom =8625
    DatasheetBackColor =16776960
    DatasheetGridlinesColor =65280
    AfterDelConfirm ="[Event Procedure]"
    RecSrcDt = Begin
        0xe66724d7b46de340
    End
    RecordSource ="hsoRptExpListCurExports"
    Caption ="Clubrecords leeftijdsgroepen"
    OnCurrent ="[Event Procedure]"
    BeforeInsert ="[Event Procedure]"
    BeforeUpdate ="[Event Procedure]"
    AfterUpdate ="[Event Procedure]"
    OnOpen ="[Event Procedure]"
    DatasheetFontName ="Arial"
    PrtMip = Begin
        0xa0050000a0050000a0050000a005000000000000201c0000e010000001000000 ,
        0x010000006801000000000000a10700000100000001000000
    End
    PrtDevMode = Begin
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x01042a019c005c0a134700000100090000000000640001000700580201000100 ,
        0x5802010000004134000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000054070000 ,
        0x5052495600200000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000001800000000001027 ,
        0x1027102700001027000000000000000034a20a000000000000000100ff000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000050001000100000000000000 ,
        0x0100000001006cd8000000000000000000000000000000000000000000010000 ,
        0x000064000100bb02880400000000000000000000000000000000000000000000 ,
        0x00000000000000000000000006000000f5ffffff000000000000000000000000 ,
        0x00000000000000010000000041007200690061006c0000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x00000000000000000000000000000000ffffff00000001000000000000000000 ,
        0x0100000000000000010000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000700070000000000020000000100000005000000 ,
        0x0001ffff00000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x00000000000000000000000009000000fffffffffefffffffefffffffeffffff ,
        0xfefffffffefffffffefffffffefffffffefffffffefffffffefffffffeffffff ,
        0xfefffffffefffffffefffffffefffffffefffffffefffffffefffffffeffffff ,
        0xfeffffff09000000ffffffff0307090001000000000000000000000005000000 ,
        0x000000000000000007000000010000000000454e474c49534800000000000000 ,
        0x000042005200530050004c003000310041002e00450058004500000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x00004200520052004200410054004f004d005f00310032003300300000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x00006f00700074005f0031003200330030002e0069006e006900000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x000063006f0070005f0031003200330030002e0069006e006900000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x000048004c0031003200330069006e0069002e00640061007400000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x000048004c003100320033006400650066002e00640061007400000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x000000000000000000000000000000000000000042005200530050004c003000 ,
        0x310041002e004500580045000000000000000000000000000000000000000000 ,
        0x00000000000000000000000000000000000000000400e4030000000001000000 ,
        0x000000000100ffff000000000e01000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000c60088000000640000000000010100000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x00000000000000000000000000000000000000000000000006000000f5ffffff ,
        0x0000000000000000000000000000000000000001000000004100720069006100 ,
        0x6c00000000000000000000000000000000000000000000000000000000000000 ,
        0x00000000000000000000000000000000000000000000000000000000ffffff00 ,
        0x0100000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x00000000000000000000000000000000000000000000000000000000ffffffff ,
        0x6400000000000000000000800000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000100000000000000454f5343
    End
    PrtDevNames = Begin
        0x08001f0036000100000000000000000000000000000000000000000000000000 ,
        0x000000000000000000000000000000000000000000004c5054313a00
    End
    OnLoad ="[Event Procedure]"
    Begin
        Begin Label
            BackStyle =0
        End
        Begin CommandButton
            Width =1701
            Height =283
            FontSize =8
            FontWeight =400
            ForeColor =-2147483630
            FontName ="MS Sans Serif"
        End
        Begin CheckBox
            SpecialEffect =2
            LabelX =230
            LabelY =-30
        End
        Begin TextBox
            SpecialEffect =2
            OldBorderStyle =0
            Width =1701
            LabelX =-1701
        End
        Begin ComboBox
            SpecialEffect =2
            Width =1701
            LabelX =-1701
        End
        Begin FormHeader
            Height =360
            BackColor =16776960
            Name ="FormHeader"
            Begin
                Begin Label
                    OverlapFlags =85
                    Left =6803
                    Top =113
                    Width =1185
                    Height =240
                    Name ="Label31"
                    Caption ="Bestandsnaam:"
                    GUID = Begin
                        0xfe942c75cdbc314c8d10e7edbcac7b99
                    End
                End
                Begin Label
                    OverlapFlags =85
                    Left =120
                    Top =120
                    Width =1350
                    Height =240
                    Name ="RO_Description_Label"
                    Caption ="Kies rapport type: "
                    GUID = Begin
                        0x3c8364a535ae3a4d87274f0e92afd92a
                    End
                End
                Begin Label
                    OverlapFlags =85
                    Left =3344
                    Top =113
                    Width =990
                    Height =240
                    Name ="RS_Code_Label"
                    Caption ="Configuratie:"
                    GUID = Begin
                        0x1562926c193e9e40a47e256a39a44c3e
                    End
                End
                Begin Label
                    OverlapFlags =85
                    Left =5670
                    Top =113
                    Width =795
                    Height =245
                    Name ="Label39"
                    Caption ="Formaat:"
                    GUID = Begin
                        0x953f0b328cce584ea2f71cd2bf301bb7
                    End
                End
            End
        End
        Begin Section
            Height =245
            BackColor =16776960
            Name ="Detail"
            Begin
                Begin TextBox
                    SpecialEffect =0
                    OverlapFlags =85
                    IMESentenceMode =3
                    Left =6810
                    Width =3846
                    TabIndex =3
                    Name ="EXP_FileName"
                    ControlSource ="EXP_FileName"
                    GUID = Begin
                        0x82fd5f2ab1f3cd4b8bf0a59401530c74
                    End
                End
                Begin ComboBox
                    SpecialEffect =0
                    OverlapFlags =85
                    IMESentenceMode =3
                    ColumnCount =2
                    ListWidth =3495
                    Left =121
                    Width =3111
                    ColumnInfo ="\"\";\"\";\"\";\"\";\"\";\"\";\"10\";\"510\""
                    GUID = Begin
                        0x454830838bd24a47a0632e027be692c4
                    End
                    Name ="cmbRptObjID"
                    ControlSource ="EXP_RPT_OBJ_ID"
                    RowSourceType ="Table/Query"
                    RowSource ="SELECT [hsoRptExpListObjects].[RO_ID], [hsoRptExpListObjects].[RO_Description], "
                        "[hsoRptExpListObjects].[RO_Order] FROM [hsoRptExpListObjects] ORDER BY [RO_Order"
                        "], [RO_ID];"
                    ColumnWidths ="0;3496"
                    AfterUpdate ="[Event Procedure]"
                    BaseInfo ="\"SELECT [hsoRptExpListObjects].[RO_ID], [hsoRptExpListObjects].[RO_Description]"
                        ", [hsoRptExpListObjects].[RO_Order] FROM [hsoRptExpListObjects] ORDER BY [RO_Ord"
                        "er], [RO_ID];\";\"hsoRptExpListObjects\";\"\";\"RO_ID\";\"RO_Description\";\"Pri"
                        "maryKey\""
                End
                Begin ComboBox
                    SpecialEffect =0
                    OverlapFlags =85
                    IMESentenceMode =3
                    ColumnCount =2
                    ListWidth =2775
                    Left =3344
                    Width =2211
                    TabIndex =1
                    BoundColumn =1
                    GUID = Begin
                        0x904ef8db77d0654693be191f778cdb34
                    End
                    Name ="cmbCfgObjID"
                    ControlSource ="EXP_CfgName"
                    RowSourceType ="Table/Query"
                    ColumnWidths ="0;2268"
                End
                Begin ComboBox
                    SpecialEffect =0
                    OverlapFlags =85
                    IMESentenceMode =3
                    ColumnCount =3
                    ListWidth =1320
                    Left =5670
                    Width =1011
                    TabIndex =2
                    ColumnInfo ="\"\";\"\";\"\";\"\";\"\";\"\";\"10\";\"510\""
                    GUID = Begin
                        0xd3afa4965d9f76409c27eced3053858a
                    End
                    Name ="cmbExpFmtObjID"
                    ControlSource ="EXP_FMT_OBJ_ID"
                    RowSourceType ="Table/Query"
                    RowSource ="SELECT [hsoRptExpListObjects].[RO_ID], [hsoRptExpListObjects].[RO_Description], "
                        "[hsoRptExpListObjects].[RO_Order] FROM [hsoRptExpListObjects] ORDER BY [RO_Order"
                        "], [RO_ID];"
                    ColumnWidths ="0;1290;30"
                    BaseInfo ="\"SELECT [hsoRptExpListObjects].[RO_ID], [hsoRptExpListObjects].[RO_Description]"
                        ", [hsoRptExpListObjects].[RO_Order] FROM [hsoRptExpListObjects] ORDER BY [RO_Ord"
                        "er], [RO_ID];\";\"hsoRptExpListObjects\";\"\";\"RO_ID\";\"RO_Description\";\"Pri"
                        "maryKey\""
                End
            End
        End
        Begin FormFooter
            Height =566
            BackColor =16776960
            Name ="FormFooter"
            Begin
                Begin CommandButton
                    OverlapFlags =85
                    AccessKey =80
                    Left =120
                    Top =120
                    Width =1810
                    Height =343
                    Name ="btnPars"
                    Caption ="&Parameters instellen..."
                    OnClick ="[Event Procedure]"
                    GUID = Begin
                        0x28344da4dba66f43ae9c6d807c7dd93d
                    End
                    UnicodeAccessKey =80
                End
                Begin CommandButton
                    OverlapFlags =85
                    AccessKey =66
                    Left =2047
                    Top =120
                    Width =1810
                    Height =343
                    TabIndex =1
                    Name ="btnZoek"
                    Caption ="&Bestandsnaam zoeken"
                    OnClick ="[Event Procedure]"
                    GUID = Begin
                        0xa6a975b6b95f3c419a0d2624a836a8df
                    End
                    UnicodeAccessKey =66
                End
            End
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Compare Database
Option Explicit


Private Sub setComboSQL(ByRef cmb As ComboBox, objTypeID As Long)
On Error Resume Next

Dim sql As String
sql = "SELECT RO_ID, RO_Description FROM hsoRptExpListObjects where ro_type_Id = " & objTypeID & _
  " ORDER BY [RO_Order], [RO_ID];"
  
cmb.RowSource = sql
  
End Sub


Private Sub initView()
On Error Resume Next
Dim sql As String

sql = "SELECT hsoRptExpListCurExports.* FROM hsoRptExpListCurExports " & _
"INNER JOIN hsoRptExpListObjects ON hsoRptExpListCurExports.EXP_RPT_OBJ_ID = " & _
"hsoRptExpListObjects.RO_ID WHERE hsoRptExpListObjects.RO_Type_ID=" & RXL_TYPE_STAT_EXPORTS & ";"

Me.RecordSource = sql

setComboSQL Me.cmbRptObjID, RXL_TYPE_STAT_EXPORTS

setComboSQL Me.cmbExpFmtObjID, RXL_TYPE_EXP_FORMATS


End Sub



Private Sub btnPars_Click()
On Error Resume Next

DoCmd.DoMenuItem A_FORMBAR, A_FILE, A_SAVERECORD, , A_MENU_VER20

Dim tpExpID As Long, tpRptObjID As Long
tpExpID = Nz([EXP_ID], -1)
tpRptObjID = Nz([EXP_RPT_OBJ_ID], -1)

If (tpExpID < 0) Or (tpRptObjID < 0) Then
  Exit Sub
End If

If Not rxlModifyParams(tpExpID, tpRptObjID) Then
  Exit Sub
End If

'Need to notify that there has been an update
Form_AfterUpdate

End Sub

Private Sub btnZoek_Click()
On Error Resume Next

DoCmd.DoMenuItem A_FORMBAR, A_FILE, A_SAVERECORD, , A_MENU_VER20

Dim tpExpID As Long, tpExpFmtObjID As Long, tpFName As String

tpExpID = Nz([EXP_ID], -1)
tpExpFmtObjID = Nz([EXP_FMT_OBJ_ID], -1)
tpFName = Nz([EXP_FileName])


If (tpExpID < 0) Then
  Exit Sub
End If

If (tpExpFmtObjID < 0) Then
  Exit Sub
End If

Dim argSExt As String
argSExt = rxlGetExtension(tpExpFmtObjID)

If argSExt = "" Then
  Exit Sub
End If

If Not DirectoryExists(extractFilePath(tpFName)) Then
  tpFName = directory_goedmaak(dbdir()) & "\*." & argSExt
End If
  

  
If Not fileNamePromptUser(FILE_DLG_SAVE, "Rapport export bestand aanmaken ", UCase(argSExt) & " bestanden (*." & argSExt & ")|*." & argSExt, tpFName, True, True) Then
  Exit Sub
End If

If (tpFName <> "") Then
  If (Right(tpFName, 4) <> "." & argSExt) Then
    tpFName = tpFName & "." & argSExt
  End If
  [EXP_FileName] = hzn(tpFName)
End If



End Sub

Private Sub cmbRptObjID_AfterUpdate()
On Error Resume Next
Dim lCfgTypeID As Long
lCfgTypeID = Nz([EXP_RPT_OBJ_ID], -1)

setComboSQL Me.cmbCfgObjID, lCfgTypeID
End Sub

Private Sub Form_AfterDelConfirm(Status As Integer)
On Error Resume Next
Dim frm As Form_RPT_EXP_LST_MASTER
Set frm = Forms("RPT_EXP_LST_MASTER")

frm.notifyChange

End Sub

Private Sub Form_AfterUpdate()
On Error Resume Next

Dim frm As Form_RPT_EXP_LST_MASTER
Set frm = Forms("RPT_EXP_LST_MASTER")

frm.notifyChange

End Sub

Private Sub Form_BeforeInsert(Cancel As Integer)
On Error Resume Next
[EXP_ID] = Nz(DMax("EXP_ID", "hsoRptExpListCurExports"), 0) + 1
End Sub

Private Sub Form_BeforeUpdate(Cancel As Integer)
On Error GoTo fout

Cancel = True

If (Nz([EXP_RPT_OBJ_ID], -1) = -1) Then
  Err.Raise 1, , "Kies een rapport type"
End If


If Nz([EXP_FMT_OBJ_ID], -1) = -1 Then
  Err.Raise 1, , "Kies een export formaat"
End If

If (Nz([EXP_FileName]) = "") Then
  'Err.Raise 1, , "Kies een bestandsnaam"
End If

  
  
Cancel = False
Exit Sub

fout:
MsgBox Err & " form_beforeUpdate" & vbCrLf & Error$, 16
Exit Sub
End Sub

Private Sub Form_Current()
On Error Resume Next
Dim lCfgTypeID As Long
lCfgTypeID = Nz([EXP_RPT_OBJ_ID], -1)

setComboSQL Me.cmbCfgObjID, lCfgTypeID

End Sub

Private Sub Form_Load()
On Error Resume Next
Me.OrderBy = ""
Me.filter = ""

initView
End Sub





Private Sub Form_Open(Cancel As Integer)
On Error Resume Next
setBackground Me
End Sub