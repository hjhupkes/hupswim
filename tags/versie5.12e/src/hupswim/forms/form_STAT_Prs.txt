Version =20
VersionRequired =20
Checksum =-624788052
Begin Form
    RecordSelectors = NotDefault
    NavigationButtons = NotDefault
    OrderByOn = NotDefault
    AllowDesignChanges = NotDefault
    ScrollBars =2
    TabularFamily =0
    PictureAlignment =2
    DatasheetGridlinesBehavior =3
    GridY =10
    Width =9504
    DatasheetFontHeight =10
    ItemSuffix =1
    Left =4965
    Top =255
    Right =17895
    Bottom =7605
    DatasheetGridlinesColor =12632256
    RecSrcDt = Begin
        0x500109e04f45e340
    End
    OnOpen ="[Event Procedure]"
    DatasheetFontName ="Arial"
    PrtMip = Begin
        0xa0050000a0050000a0050000a005000000000000201c0000e010000001000000 ,
        0x010000006801000000000000a10700000100000001000000
    End
    PrtDevMode = Begin
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x01042a019c005c0a134700000100090000000000640001000700580201000100 ,
        0x5802010000004134000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000054070000 ,
        0x5052495600200000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000001800000000001027 ,
        0x1027102700001027000000000000000034a20a000000000000000100ff000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000050001000100000000000000 ,
        0x0100000001006cd8000000000000000000000000000000000000000000010000 ,
        0x000064000100bb02880400000000000000000000000000000000000000000000 ,
        0x00000000000000000000000006000000f5ffffff000000000000000000000000 ,
        0x00000000000000010000000041007200690061006c0000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x00000000000000000000000000000000ffffff00000001000000000000000000 ,
        0x0100000000000000010000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000700070000000000020000000100000005000000 ,
        0x0001ffff00000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x00000000000000000000000009000000fffffffffefffffffefffffffeffffff ,
        0xfefffffffefffffffefffffffefffffffefffffffefffffffefffffffeffffff ,
        0xfefffffffefffffffefffffffefffffffefffffffefffffffefffffffeffffff ,
        0xfeffffff09000000ffffffff0307090001000000000000000000000005000000 ,
        0x000000000000000007000000010000000000454e474c49534800000000000000 ,
        0x000042005200530050004c003000310041002e00450058004500000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x00004200520052004200410054004f004d005f00310032003300300000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x00006f00700074005f0031003200330030002e0069006e006900000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x000063006f0070005f0031003200330030002e0069006e006900000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x000048004c0031003200330069006e0069002e00640061007400000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x000048004c003100320033006400650066002e00640061007400000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x000000000000000000000000000000000000000042005200530050004c003000 ,
        0x310041002e004500580045000000000000000000000000000000000000000000 ,
        0x00000000000000000000000000000000000000000400e4030000000001000000 ,
        0x000000000100ffff000000000e01000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000c60088000000640000000000010100000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x00000000000000000000000000000000000000000000000006000000f5ffffff ,
        0x0000000000000000000000000000000000000001000000004100720069006100 ,
        0x6c00000000000000000000000000000000000000000000000000000000000000 ,
        0x00000000000000000000000000000000000000000000000000000000ffffff00 ,
        0x0100000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x00000000000000000000000000000000000000000000000000000000ffffffff ,
        0x6400000000000000000000800000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000100000000000000454f5343
    End
    PrtDevNames = Begin
        0x08001f0036000100000000000000000000000000000000000000000000000000 ,
        0x000000000000000000000000000000000000000000004c5054313a00
    End
    OnLoad ="[Event Procedure]"
    Begin
        Begin Label
            BackStyle =0
            FontName ="Tahoma"
        End
        Begin CommandButton
            Width =1701
            Height =283
            FontSize =8
            FontWeight =400
            ForeColor =-2147483630
            FontName ="Tahoma"
        End
        Begin OptionButton
            SpecialEffect =2
            LabelX =230
            LabelY =-30
        End
        Begin CheckBox
            SpecialEffect =2
            LabelX =230
            LabelY =-30
        End
        Begin OptionGroup
            SpecialEffect =3
            Width =1701
            Height =1701
        End
        Begin TextBox
            FELineBreak = NotDefault
            SpecialEffect =2
            OldBorderStyle =0
            Width =1701
            LabelX =-1701
            FontName ="Tahoma"
            AsianLineBreak =255
        End
        Begin FormHeader
            Height =3273
            BackColor =16776960
            Name ="FormHeader"
            GUID = Begin
                0xf7aa80897ab23e4bb950a6866bcc9407
            End
            Begin
                Begin Label
                    BackStyle =1
                    OverlapFlags =85
                    Left =113
                    Top =3063
                    Width =630
                    Height =210
                    Name ="lbStartnr"
                    Caption ="Startnr: "
                    FontName ="MS Sans Serif"
                    GUID = Begin
                        0xb924dd104fe1b640801be57f208a7056
                    End
                End
                Begin Label
                    BackStyle =1
                    OverlapFlags =85
                    Left =3741
                    Top =3063
                    Width =900
                    Height =210
                    Name ="lbPRs"
                    Caption ="Aantal PR's"
                    FontName ="MS Sans Serif"
                    GUID = Begin
                        0x502b2cdcb4c1d24a8d99b8123d44bc3b
                    End
                End
                Begin Label
                    BackStyle =1
                    OverlapFlags =85
                    Left =4818
                    Top =3063
                    Width =1425
                    Height =210
                    Name ="lbTotVerb"
                    Caption ="Tot.tijdsverb: (sec)"
                    FontName ="MS Sans Serif"
                    GUID = Begin
                        0xae148b7ad8dac54b86bfac0c7ed67a10
                    End
                End
                Begin Label
                    BackStyle =1
                    OverlapFlags =85
                    Left =6405
                    Top =3061
                    Width =1710
                    Height =210
                    Name ="lbNWed"
                    Caption ="Aantal gez wedstrijden "
                    FontName ="MS Sans Serif"
                    GUID = Begin
                        0x36877ccd55cf6a4bbb5dc350a56a3ef7
                    End
                End
                Begin TextBox
                    FELineBreak = NotDefault
                    SpecialEffect =0
                    OverlapFlags =85
                    Left =1355
                    Top =116
                    Width =966
                    Name ="datum1"
                    Format ="dd-mm-yyyy"
                    AfterUpdate ="[Event Procedure]"
                    FontName ="MS Sans Serif"
                    GUID = Begin
                        0x12dd5ff6f5f23245bf4e6a4e0fd8352b
                    End
                    AsianLineBreak =0
                    Begin
                        Begin Label
                            BackStyle =1
                            OverlapFlags =85
                            Left =113
                            Top =113
                            Width =1065
                            Height =240
                            Name ="labdat1"
                            Caption ="Startdatum:"
                            FontName ="MS Sans Serif"
                            GUID = Begin
                                0x485932f123e30d4fb6510bd21c754dda
                            End
                        End
                    End
                End
                Begin TextBox
                    FELineBreak = NotDefault
                    SpecialEffect =0
                    OverlapFlags =85
                    Left =1355
                    Top =457
                    Width =966
                    TabIndex =1
                    Name ="datum2"
                    Format ="dd-mm-yyyy"
                    AfterUpdate ="[Event Procedure]"
                    FontName ="MS Sans Serif"
                    GUID = Begin
                        0x68619eeaf3a9124c8e8bada5492f56e0
                    End
                    AsianLineBreak =0
                    Begin
                        Begin Label
                            BackStyle =1
                            OverlapFlags =85
                            Left =113
                            Top =454
                            Width =1065
                            Height =240
                            Name ="labdat2"
                            Caption ="Einddatum:"
                            FontName ="MS Sans Serif"
                            GUID = Begin
                                0x1fc0d9aba9a99947b558cee64fa6a6d2
                            End
                        End
                    End
                End
                Begin CommandButton
                    OverlapFlags =85
                    AccessKey =66
                    Left =56
                    Top =2040
                    Width =1311
                    Height =343
                    FontSize =10
                    FontWeight =700
                    TabIndex =5
                    Name ="btnBereken"
                    Caption ="&Bereken"
                    OnClick ="[Event Procedure]"
                    FontName ="MS Sans Serif"
                    GUID = Begin
                        0x550b81c3cac6c74694e8d24042fe583d
                    End
                End
                Begin Label
                    OverlapFlags =85
                    Left =56
                    Top =2437
                    Width =9300
                    Height =480
                    Name ="Label32"
                    Caption ="Deze optie geeft per zwemmer het aantal gezwommen persoonlijke records in de per"
                        "iode tussen <Startdatum> en <Einddatum>. \015\012NB: Indien een zwemmer een afst"
                        "and voor de eerste keer zwemt, telt dit NIET mee als PR. "
                    FontName ="MS Sans Serif"
                    GUID = Begin
                        0x8a111a3c6d66dc4eb06b7ba92220263f
                    End
                End
                Begin CheckBox
                    SpecialEffect =0
                    OverlapFlags =85
                    Left =113
                    Top =870
                    TabIndex =2
                    Name ="blApart"
                    AfterUpdate ="[Event Procedure]"
                    DefaultValue ="False"
                    GUID = Begin
                        0x9d25c8af9436544884ac0633957f69f6
                    End
                    Begin
                        Begin Label
                            BackStyle =1
                            OverlapFlags =247
                            Left =336
                            Top =846
                            Width =2985
                            Height =240
                            Name ="Label44"
                            Caption ="Aparte PR's voor de 50m baan bijhouden"
                            FontName ="MS Sans Serif"
                            GUID = Begin
                                0xc2b6243f1b1d164c8326e9c0345ea51b
                            End
                        End
                    End
                End
                Begin OptionGroup
                    SpecialEffect =0
                    OverlapFlags =85
                    Left =5102
                    Top =343
                    Width =2972
                    Height =1213
                    TabIndex =6
                    Name ="sortOrder"
                    AfterUpdate ="[Event Procedure]"
                    DefaultValue ="1"
                    GUID = Begin
                        0xfcb4d65bb429564c8a08c14a8ebc7710
                    End
                    Begin
                        Begin Label
                            BackStyle =1
                            OverlapFlags =215
                            Left =5102
                            Top =113
                            Width =1050
                            Height =240
                            Name ="Label48"
                            Caption ="Sorteer opties"
                            FontName ="MS Sans Serif"
                            GUID = Begin
                                0xc3f5266707c89942a22c42f26c62a9dc
                            End
                        End
                        Begin OptionButton
                            SpecialEffect =0
                            OverlapFlags =87
                            Left =5288
                            Top =521
                            OptionValue =1
                            Name ="Option50"
                            GUID = Begin
                                0xe0dc56b75410a14295e15d9663578165
                            End
                            Begin
                                Begin Label
                                    BackStyle =1
                                    OverlapFlags =247
                                    Left =5518
                                    Top =493
                                    Width =900
                                    Height =240
                                    Name ="Label51"
                                    Caption ="Aantal PR's"
                                    FontName ="MS Sans Serif"
                                    GUID = Begin
                                        0x13726c5ab413c344b6e34a20da202f4d
                                    End
                                End
                            End
                        End
                        Begin OptionButton
                            SpecialEffect =0
                            OverlapFlags =87
                            Left =5288
                            Top =851
                            OptionValue =2
                            Name ="Option52"
                            GUID = Begin
                                0xa6689a496ae040478b51709b6d2bbfa1
                            End
                            Begin
                                Begin Label
                                    BackStyle =1
                                    OverlapFlags =247
                                    Left =5518
                                    Top =823
                                    Width =1485
                                    Height =240
                                    Name ="Label53"
                                    Caption ="Tot Tijdsverbetering"
                                    FontName ="MS Sans Serif"
                                    GUID = Begin
                                        0x3e942c4f44447641b5cf08f2d447662d
                                    End
                                End
                            End
                        End
                        Begin OptionButton
                            SpecialEffect =0
                            OverlapFlags =87
                            Left =5288
                            Top =1181
                            OptionValue =3
                            Name ="Option54"
                            GUID = Begin
                                0xe6587b6064782e48880872ceb7fe26f8
                            End
                            Begin
                                Begin Label
                                    BackStyle =1
                                    OverlapFlags =247
                                    Left =5518
                                    Top =1153
                                    Width =2370
                                    Height =240
                                    Name ="Label55"
                                    Caption ="Aantal Gezwommen Wedstrijden"
                                    FontName ="MS Sans Serif"
                                    GUID = Begin
                                        0x4c47e94e3991dd4c817cbb09cf303b9d
                                    End
                                End
                            End
                        End
                    End
                End
                Begin CheckBox
                    SpecialEffect =0
                    OverlapFlags =85
                    Left =113
                    Top =1227
                    TabIndex =3
                    Name ="blRestrictAfSl"
                    AfterUpdate ="[Event Procedure]"
                    DefaultValue ="False"
                    GUID = Begin
                        0x71e22028f27d3343adda83cb57dff2ab
                    End
                    Begin
                        Begin Label
                            BackStyle =1
                            OverlapFlags =247
                            Left =336
                            Top =1190
                            Width =3465
                            Height =240
                            Name ="Label57"
                            Caption ="Beperking opleggen aan meetellende afstanden"
                            FontName ="MS Sans Serif"
                            GUID = Begin
                                0x9cc7f3ff6eb84943b590df25a66c75b1
                            End
                        End
                    End
                End
                Begin CommandButton
                    OverlapFlags =85
                    AccessKey =77
                    Left =453
                    Top =1474
                    Width =1875
                    Height =330
                    TabIndex =4
                    Name ="btnMeetel"
                    Caption ="&Meetellende afstanden"
                    OnClick ="[Event Procedure]"
                    FontName ="MS Sans Serif"
                    GUID = Begin
                        0x2f0dc84a9a908845aa7e5232b7866faf
                    End
                End
                Begin CommandButton
                    TabStop = NotDefault
                    OverlapFlags =85
                    TextFontFamily =2
                    Left =5102
                    Top =1647
                    Width =381
                    Height =315
                    FontSize =10
                    FontWeight =700
                    TabIndex =7
                    ForeColor =0
                    Name ="btnLoadPRC"
                    Caption ="btnLoadRnk"
                    OnClick ="[Event Procedure]"
                    PictureData = Begin
                        0x2800000010000000100000000100040000000000800000000000000000000000 ,
                        0x0000000000000000000000000000800000800000008080008000000080008000 ,
                        0x8080000080808000c0c0c0000000ff00c0c0c00000ffff00ff000000c0c0c000 ,
                        0xffff0000ffffff00dadadadadadadadaadadadadadadadad00000000000adada ,
                        0x003333333330adad0b03333333330ada0fb03333333330ad0bfb03333333330a ,
                        0x0fbfb000000000000bfbfbfbfb0adada0fbfbfbfbf0dadad0bfb0000000adada ,
                        0xa000adadadad000ddadadadadadad00aadadadad0dad0d0ddadadadad000dada ,
                        0xadadadadadadadad
                    End
                    FontName ="System"
                    ObjectPalette = Begin
                        0x0003100000000000800000000080000080800000000080008000800000808000 ,
                        0x80808000c0c0c000ff000000c0c0c000ffff00000000ff00c0c0c00000ffff00 ,
                        0xffffff0000000000
                    End
                    GUID = Begin
                        0xe3dbf47deec3984b91efac9ce8240c90
                    End
                End
                Begin CommandButton
                    TabStop = NotDefault
                    OverlapFlags =85
                    TextFontFamily =2
                    Left =5526
                    Top =1644
                    Width =381
                    Height =315
                    FontSize =10
                    FontWeight =700
                    TabIndex =8
                    ForeColor =0
                    Name ="btnSavePRC"
                    Caption ="btnSaveRnk"
                    OnClick ="[Event Procedure]"
                    PictureData = Begin
                        0x2800000010000000100000000100040000000000800000000000000000000000 ,
                        0x0000000000000000000000000000800000800000008080008000000080008000 ,
                        0x8080000080808000c0c0c0000000ff00c0c0c00000ffff00ff000000c0c0c000 ,
                        0xffff0000ffffff00dadadadadadadadaad000000000000add0330880000330da ,
                        0xa0330880000330add0330880000330daa0330000000330add0333333333330da ,
                        0xa0330000000330add030fffffff030daa030fccccff030add030ffcccff030da ,
                        0xa03dfccccff000add0dacccfcff070daadacccadad0000addacccadadadadada ,
                        0xadacadadadadadad
                    End
                    FontName ="System"
                    ObjectPalette = Begin
                        0x0003100000000000800000000080000080800000000080008000800000808000 ,
                        0x80808000c0c0c000ff000000c0c0c000ffff00000000ff00c0c0c00000ffff00 ,
                        0xffffff0000000000
                    End
                    GUID = Begin
                        0xa2f6bc58105bf441913db033ee7dda67
                    End
                End
            End
        End
        Begin Section
            Height =240
            BackColor =16776960
            Name ="Detail"
            GUID = Begin
                0xe98a6248ab1c9d42ae89dbe41f2ca6dc
            End
            Begin
                Begin TextBox
                    Enabled = NotDefault
                    Locked = NotDefault
                    FELineBreak = NotDefault
                    SpecialEffect =0
                    OverlapFlags =85
                    TextAlign =1
                    Left =113
                    Width =846
                    Name ="prs_startnummer"
                    ControlSource ="prs_startnummer"
                    Format ="00-000"
                    FontName ="MS Sans Serif"
                    GUID = Begin
                        0xc0943770dc7308488da2889ddd410679
                    End
                    AsianLineBreak =0
                End
                Begin TextBox
                    Enabled = NotDefault
                    Locked = NotDefault
                    FELineBreak = NotDefault
                    SpecialEffect =0
                    OverlapFlags =85
                    Left =1077
                    Width =2376
                    TabIndex =1
                    Name ="prs_name"
                    ControlSource ="prs_name"
                    FontName ="MS Sans Serif"
                    GUID = Begin
                        0x7ec6958debef094f91bc9b17c8d08af5
                    End
                    AsianLineBreak =0
                End
                Begin TextBox
                    Enabled = NotDefault
                    Locked = NotDefault
                    FELineBreak = NotDefault
                    SpecialEffect =0
                    OverlapFlags =85
                    Left =3741
                    Width =681
                    TabIndex =2
                    Name ="prs_aantalPrs"
                    ControlSource ="prs_aantalPrs"
                    FontName ="MS Sans Serif"
                    GUID = Begin
                        0xe2adf13b970fa049a22cef443143ca7e
                    End
                    AsianLineBreak =0
                End
                Begin TextBox
                    Enabled = NotDefault
                    Locked = NotDefault
                    FELineBreak = NotDefault
                    SpecialEffect =0
                    OverlapFlags =85
                    Left =4818
                    Width =966
                    TabIndex =3
                    Name ="prs_verbeteringSecs"
                    ControlSource ="prs_verbeteringSecs"
                    Format ="00.0#"
                    FontName ="MS Sans Serif"
                    GUID = Begin
                        0x667a8c1e7c05bf4c9ce62fd12398f817
                    End
                    AsianLineBreak =0
                End
                Begin TextBox
                    Enabled = NotDefault
                    Locked = NotDefault
                    FELineBreak = NotDefault
                    SpecialEffect =0
                    OverlapFlags =85
                    Left =6406
                    Width =681
                    TabIndex =4
                    Name ="prs_aantalWedstrijden"
                    ControlSource ="prs_aantalWedstrijden"
                    FontName ="MS Sans Serif"
                    GUID = Begin
                        0x701f073ff50d874e8f7b22448aba5a32
                    End
                    AsianLineBreak =0
                End
            End
        End
        Begin FormFooter
            Height =615
            BackColor =16776960
            Name ="FormFooter"
            GUID = Begin
                0x4b158856598c5248b22c9e713b55b7cb
            End
            Begin
                Begin CommandButton
                    OverlapFlags =85
                    AccessKey =75
                    Left =6909
                    Top =113
                    Width =1194
                    Height =408
                    FontSize =10
                    FontWeight =700
                    Name ="btnBekijk"
                    Caption ="Be&kijken"
                    OnClick ="[Event Procedure]"
                    FontName ="MS Sans Serif"
                    GUID = Begin
                        0xa4597ddba31b814f850ca3b9c1f81c41
                    End
                End
                Begin CommandButton
                    OverlapFlags =85
                    Left =5616
                    Top =113
                    Width =1194
                    Height =408
                    FontSize =10
                    FontWeight =700
                    TabIndex =1
                    Name ="btnDetails"
                    Caption ="Details"
                    OnClick ="[Event Procedure]"
                    FontName ="MS Sans Serif"
                    GUID = Begin
                        0xbff610570ba7cb46b7b6620e169b9201
                    End
                End
            End
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Compare Database
Option Explicit

Private blBerekend As Boolean
Private nAfSl As Integer
Private ordAf(0 To MAX_N_REC_AFSL) As String
Private ordSl(0 To MAX_N_REC_AFSL) As String

Private sLastUsedCfgName As String
Private lLastUsedCfgType As Long


Private Sub initView()
On Error Resume Next
  nAfSl = 0
  markUncalc
End Sub

Private Sub markUncalc()
On Error Resume Next
blBerekend = False
If (Me.RecordSource <> "") Then
  Me.RecordSource = ""
End If
updateView
End Sub


Private Sub applyOrder()
On Error Resume Next
Dim so As Integer
so = Nz(Me.sortOrder)
Select Case so
  Case 1
    Me.OrderBy = "[prs_aantalprs] desc, [prs_verbeteringsecs] desc, [prs_aantalwedstrijden] desc"
  Case 2
    Me.OrderBy = "[prs_verbeteringsecs] desc, [prs_aantalprs] desc, [prs_aantalwedstrijden] desc"
  Case 3
    Me.OrderBy = "[prs_aantalWedstrijden] desc, [prs_aantalprs] desc, [prs_verbeteringsecs] desc"
End Select

Me.OrderByOn = True


End Sub


Private Sub updateView()
On Error Resume Next

Me.prs_startnummer.Visible = blBerekend
Me.prs_name.Visible = blBerekend
Me.prs_aantalPrs.Visible = blBerekend
Me.prs_verbeteringSecs.Visible = blBerekend
Me.prs_aantalWedstrijden.Visible = blBerekend

Me.btnBekijk.Enabled = blBerekend
Me.btnDetails.Enabled = blBerekend

Me.btnMeetel.Enabled = Nz(Me.blRestrictAfSl)

End Sub


Private Sub calculate()
On Error Resume Next

blBerekend = False

Me.RecordSource = ""
updateView
Me.Repaint

Dim startDate As Date
Dim endDate As Date

startDate = Nz(Me.datum1, #1/1/1900#)
endDate = Nz(Me.datum2, #1/1/1900#)

If Not lenDateIsValid(startDate) Then
  MsgBox "Vul een startdatum in", vbCritical
  Me.datum1.SetFocus
End If

If Not lenDateIsValid(endDate) Then
  MsgBox "Vul een einddatum in", vbCritical
  Me.datum2.SetFocus
End If

If Not prCount(startDate, endDate, Nz(Me.blApart), Nz(Me.blRestrictAfSl), nAfSl, ordAf, ordSl) Then
  Exit Sub
End If

blBerekend = True
Me.RecordSource = "Select * from [~prCompetitie];"

applyOrder


updateView

Me.Requery


End Sub


Private Sub blApart_AfterUpdate()
On Error Resume Next
markUncalc
End Sub

Private Sub blRestrictAfSl_AfterUpdate()
On Error Resume Next
markUncalc
End Sub



Private Sub btnLoadPRC_Click()
On Error Resume Next

If Not rxcGenerateStructure() Then
  Exit Sub
End If

Dim isOK As Boolean
Dim lkpCfgName As String
If Not rxcPromptUser(False, "", RXL_OBJ_RPT_TYPE_STAT_PRC, isOK, lkpCfgName) Then
  Exit Sub
End If

If (Not isOK) Then
  Exit Sub
End If

If Not loadPRCOpts(lkpCfgName) Then
  Exit Sub
End If

lLastUsedCfgType = RXL_OBJ_RPT_TYPE_STAT_PRC
sLastUsedCfgName = lkpCfgName


markUncalc



End Sub

Private Sub btnMeetel_Click()
On Error Resume Next
Dim isOK As Boolean
If Not afslListPromptUser(True, False, isOK, nAfSl, ordAf, ordSl) Then
  Exit Sub
End If
If (isOK) Then
  markUncalc
End If
  
End Sub

Private Sub btnSavePRC_Click()
On Error Resume Next

If Not rxcGenerateStructure() Then
  Exit Sub
End If

Dim sPrvName As String
sPrvName = ""

If (lLastUsedCfgType = RXL_OBJ_RPT_TYPE_STAT_PRC) Then
  sPrvName = sLastUsedCfgName
End If


Dim isOK As Boolean
Dim lkpCfgName As String
If Not rxcPromptUser(True, sPrvName, RXL_OBJ_RPT_TYPE_STAT_PRC, isOK, lkpCfgName) Then
  Exit Sub
End If

If (Not isOK) Then
  Exit Sub
End If

If Not savePRCOpts(lkpCfgName) Then
  Exit Sub
End If



lLastUsedCfgType = RXL_OBJ_RPT_TYPE_STAT_PRC
sLastUsedCfgName = lkpCfgName

End Sub

Private Sub datum1_AfterUpdate()
On Error Resume Next
markUncalc
End Sub

Private Sub datum2_AfterUpdate()
On Error Resume Next
markUncalc
End Sub

Private Sub Form_Load()
On Error Resume Next
initView
sLastUsedCfgName = ""
lLastUsedCfgType = -1
End Sub


Private Sub btnBereken_click()
On Error Resume Next
calculate
End Sub

Private Sub Form_Open(Cancel As Integer)
On Error Resume Next
setBackground Me
End Sub

Private Sub sortOrder_afterUpdate()
On Error Resume Next
applyOrder
End Sub


Private Sub handleReport(ByVal blDetails As Boolean)
On Error Resume Next
If Not rxpSetPRCompOptions(Nz(Me.sortOrder), blDetails) Then
  Exit Sub
End If

Dim vDummy(0 To 0) As Variant

If Not rptHandle(False, REP_PRs, RPT_MODE_PREVIEW, 0, 0, 0, vDummy) Then
  Exit Sub
End If


End Sub

Private Sub btnBekijk_Click()
On Error Resume Next
handleReport (False)
End Sub

Private Sub btnDetails_Click()
On Error Resume Next
handleReport (True)
End Sub




Private Function savePRCOpts(ByVal sName As String) As Boolean
On Error GoTo fout
savePRCOpts = False


Dim prcOpts As RXC_STAT_PRC_OPTS



prcOpts.dStartDate = Nz(Me.datum1, #1/1/1900#)
prcOpts.dEndDate = Nz(Me.datum2, #1/1/1900#)

prcOpts.iSortOrder = Nz(Me.sortOrder)

prcOpts.blSepRecords50m = Nz(Me.blApart)
prcOpts.blRestrictAfSl = Nz(Me.blRestrictAfSl)


If Not rxcStoreStatPRCOpts(sName, prcOpts, nAfSl, ordAf, ordSl) Then
  Exit Function
End If


savePRCOpts = True
Exit Function
fout:
MsgBox Err & " savePRCOpts" & vbCrLf & Error$, 16
Exit Function
End Function




Private Function loadPRCOpts(ByVal sName As String) As Boolean
On Error GoTo fout
loadPRCOpts = False


Dim prcOpts As RXC_STAT_PRC_OPTS

If Not rxcLoadStatPRCOpts(sName, prcOpts, nAfSl, ordAf, ordSl) Then
  Exit Function
End If

Me.datum1 = IIf(lenDateIsValid(prcOpts.dStartDate), prcOpts.dStartDate, Null)
Me.datum2 = IIf(lenDateIsValid(prcOpts.dEndDate), prcOpts.dEndDate, Null)

Me.sortOrder = prcOpts.iSortOrder

Me.blApart = prcOpts.blSepRecords50m
Me.blRestrictAfSl = prcOpts.blRestrictAfSl

loadPRCOpts = True
Exit Function
fout:
MsgBox Err & " loadPRCOpts" & vbCrLf & Error$, 16
Exit Function
End Function