Version =20
VersionRequired =20
Checksum =1101475500
Begin Report
    LayoutForPrint = NotDefault
    DateGrouping =1
    GridX =15
    GridY =15
    Width =10926
    ItemSuffix =96
    Left =1260
    Top =810
    Right =14205
    Bottom =6900
    ShortcutMenuBar ="gShortcutRpt"
    Toolbar ="gRptToolbar"
    RecSrcDt = Begin
        0x1ae3eb927c5ee340
    End
    RecordSource ="SELECT [__punten].* FROM __punten ;"
    OnOpen ="[Event Procedure]"
    MenuBar ="gMnBasic"
    PrtMip = Begin
        0x37020000530300001c0100005303000000000000ae2a0000f000000001000000 ,
        0x010000006801000000000000a10700000100000000000000
    End
    PrtDevMode = Begin
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x010402059c00c40253ef800101000900ea0a6f08640001000f00580202000100 ,
        0x5802030001004c65747465720000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000010000000000000001000000 ,
        0x0200000001000000000000000000000000000000000000000000000050524956 ,
        0xe230000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000180000000000102710271027 ,
        0x0000102700000000000000000000c40200000000000000000000000000000000 ,
        0x00000000000000000300000000000000000010005c4b03006843040000000000 ,
        0x000000000000010000000000000000000000000000000000e7b14b4c03000000 ,
        0x05000400ff000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000
    End
    PrtDevNames = Begin
        0x080013001e000100000000000000000000000000000000000000000000005044 ,
        0x4643726561746f723a00
    End
    Begin
        Begin Label
            FontSize =10
            FontName ="Arial"
        End
        Begin TextBox
            OldBorderStyle =0
            Width =1701
            LabelX =-1701
            FontSize =10
            FontName ="Arial"
        End
        Begin Subform
            OldBorderStyle =0
            Width =1701
            Height =1701
        End
        Begin BreakLevel
            ControlSource ="PT_Wedstrijdnummer"
        End
        Begin BreakLevel
            ControlSource ="=Val([pt_programmanummer])"
        End
        Begin BreakLevel
            ControlSource ="PT_Is_InitVals"
        End
        Begin BreakLevel
            GroupHeader = NotDefault
            GroupFooter = NotDefault
            KeepTogether =2
            ControlSource ="pt_programmanummer"
        End
        Begin BreakLevel
            ControlSource ="PT_PNT_GRP_ABC"
        End
        Begin BreakLevel
            GroupHeader = NotDefault
            GroupFooter = NotDefault
            KeepTogether =1
            ControlSource ="PT_PNT_GRP_CatIdx"
        End
        Begin BreakLevel
            ControlSource ="PT_RankingCounter"
        End
        Begin BreakLevel
            ControlSource ="pt_vereniging"
        End
        Begin FormHeader
            KeepTogether = NotDefault
            Height =539
            OnFormat ="[Event Procedure]"
            Name ="scRepHeader"
            Begin
                Begin TextBox
                    TextAlign =2
                    Width =10926
                    Height =376
                    FontSize =12
                    FontWeight =700
                    Name ="fldTitle"
                End
            End
        End
        Begin PageHeader
            Height =0
            Name ="scPageHeader"
        End
        Begin BreakHeader
            KeepTogether = NotDefault
            Height =480
            BreakLevel =3
            OnFormat ="[Event Procedure]"
            Name ="scProgHeader"
            Begin
                Begin Label
                    Width =9195
                    Height =250
                    FontSize =8
                    FontWeight =700
                    Name ="lbTussenstand"
                    Caption ="Tussenstand "
                End
                Begin TextBox
                    Width =9921
                    FontSize =8
                    FontWeight =700
                    Name ="fldProgDes"
                    ControlSource ="=\"Progr. nr. \" & [pt_programmanummer] & \"   \" & fmtProgDes(nz([pt_type]),nz("
                        "[pt_beschrijving_afwijkend]),[pt_afstand],[pt_slag],[pt_beschrijving_categorie])"
                        " & fmtProgOpm(\"\",\"\",nz([PT_vervangende_tijd]),True)"
                End
                Begin Label
                    Left =480
                    Top =240
                    Width =1695
                    Height =240
                    FontSize =8
                    FontWeight =700
                    Name ="lbVereniging"
                    Caption ="Vereniging"
                End
                Begin Label
                    TextAlign =1
                    Left =3320
                    Top =240
                    Width =510
                    Height =240
                    FontSize =8
                    FontWeight =700
                    Name ="lbT1"
                    Caption ="Tijd1"
                End
                Begin Label
                    TextAlign =1
                    Left =3930
                    Top =240
                    Width =675
                    Height =240
                    FontSize =8
                    FontWeight =700
                    Name ="lbP1"
                    Caption ="Punt1"
                End
                Begin Label
                    TextAlign =1
                    Left =5026
                    Top =240
                    Width =510
                    Height =240
                    FontSize =8
                    FontWeight =700
                    Name ="lbT2"
                    Caption ="Tijd2"
                End
                Begin Label
                    TextAlign =1
                    Left =4346
                    Top =240
                    Width =660
                    Height =240
                    FontSize =8
                    FontWeight =700
                    Name ="lbP2"
                    Caption ="Punt2"
                End
                Begin Label
                    TextAlign =1
                    Left =9153
                    Top =240
                    Width =660
                    Height =240
                    FontSize =8
                    FontWeight =700
                    Name ="lbST"
                    Caption ="Subtot"
                End
                Begin Label
                    TextAlign =1
                    Left =10015
                    Top =240
                    Width =750
                    Height =240
                    FontSize =8
                    FontWeight =700
                    Name ="lbTot"
                    Caption ="Totaal"
                End
                Begin TextBox
                    Visible = NotDefault
                    Left =2494
                    Top =240
                    Width =786
                    FontSize =8
                    TabIndex =1
                    Name ="PT_Is_InitVals"
                    ControlSource ="PT_Is_InitVals"
                End
                Begin Label
                    TextAlign =1
                    Left =6085
                    Top =240
                    Width =540
                    Height =240
                    FontSize =8
                    FontWeight =700
                    Name ="lbT3"
                    Caption ="Tijd3"
                End
                Begin Label
                    TextAlign =1
                    Left =5366
                    Top =240
                    Width =660
                    Height =240
                    FontSize =8
                    FontWeight =700
                    Name ="lbP3"
                    Caption ="Punt3"
                End
                Begin Label
                    TextAlign =1
                    Left =7105
                    Top =240
                    Width =540
                    Height =240
                    FontSize =8
                    FontWeight =700
                    Name ="lbT4"
                    Caption ="Tijd4"
                End
                Begin Label
                    TextAlign =1
                    Left =6500
                    Top =240
                    Width =660
                    Height =240
                    FontSize =8
                    FontWeight =700
                    Name ="lbP4"
                    Caption ="Punt4"
                End
                Begin TextBox
                    Visible = NotDefault
                    Left =9600
                    Width =951
                    TabIndex =2
                    Name ="PT_Is_Estaf"
                    ControlSource ="PT_Is_Estaf"
                End
                Begin Label
                    TextAlign =1
                    Left =9645
                    Top =240
                    Width =300
                    Height =240
                    FontSize =8
                    FontWeight =700
                    Name ="lbTotGold"
                    Caption ="G"
                    GUID = Begin
                        0xfd1d01272045df42958be70b740e81ea
                    End
                End
                Begin Label
                    TextAlign =1
                    Left =10050
                    Top =240
                    Width =300
                    Height =240
                    FontSize =8
                    FontWeight =700
                    Name ="lbTotSilver"
                    Caption ="Z"
                    GUID = Begin
                        0x086acf7553d37143a2ba87e1cad59eb1
                    End
                End
                Begin Label
                    TextAlign =1
                    Left =10465
                    Top =240
                    Width =300
                    Height =240
                    FontSize =8
                    FontWeight =700
                    Name ="lbTotBronze"
                    Caption ="B"
                    GUID = Begin
                        0x4e1ad60087b23844acde13b782652dee
                    End
                End
                Begin TextBox
                    Visible = NotDefault
                    IMESentenceMode =3
                    Left =9864
                    Width =351
                    TabIndex =3
                    Name ="PT_Wedstrijdnummer"
                    ControlSource ="PT_Wedstrijdnummer"
                    GUID = Begin
                        0x3fdfbf5fcaa04640acb5bc375f0d6b6a
                    End
                End
                Begin TextBox
                    Visible = NotDefault
                    IMESentenceMode =3
                    Left =10318
                    Width =336
                    TabIndex =4
                    Name ="PT_Programmanummer"
                    ControlSource ="PT_Programmanummer"
                    GUID = Begin
                        0xec21981050a60e40bbebc7cac568882b
                    End
                End
                Begin TextBox
                    Visible = NotDefault
                    IMESentenceMode =3
                    Left =10469
                    Width =366
                    TabIndex =5
                    Name ="PT_Type"
                    ControlSource ="PT_Type"
                    GUID = Begin
                        0xf1eb2ff0970123459fb334c4a8ce90a7
                    End
                End
            End
        End
        Begin BreakHeader
            KeepTogether = NotDefault
            CanShrink = NotDefault
            Height =240
            BreakLevel =5
            OnFormat ="[Event Procedure]"
            Name ="scCatHeader"
            Begin
                Begin TextBox
                    CanShrink = NotDefault
                    FontItalic = NotDefault
                    TextAlign =1
                    Width =7191
                    FontSize =8
                    Name ="fldGrpDes"
                    ControlSource ="=nz([PT_pnt_Grp_beschrijving],\"\")"
                End
                Begin TextBox
                    Visible = NotDefault
                    IMESentenceMode =3
                    Left =7305
                    Width =531
                    TabIndex =1
                    Name ="PT_PNT_GRP_CatIdx"
                    ControlSource ="PT_PNT_GRP_CatIdx"
                    GUID = Begin
                        0x3167577c6941874985f7b2eac03057bf
                    End
                End
                Begin TextBox
                    Visible = NotDefault
                    IMESentenceMode =3
                    Left =8023
                    Width =441
                    TabIndex =2
                    Name ="PT_PNT_GRP_ABC"
                    ControlSource ="PT_PNT_GRP_ABC"
                    GUID = Begin
                        0x363a2e3c3d6ec04c92d6310f2a186cf0
                    End
                End
            End
        End
        Begin Section
            KeepTogether = NotDefault
            Height =240
            OnFormat ="[Event Procedure]"
            Name ="scDetail"
            Begin
                Begin TextBox
                    TextAlign =1
                    Left =9162
                    Width =786
                    ColumnWidth =780
                    FontSize =8
                    Name ="fldSubTot"
                    ControlSource ="=fmtPnt(nz([pt_subtotaal]),True)"
                End
                Begin TextBox
                    TextAlign =1
                    Left =10015
                    Width =907
                    FontSize =8
                    TabIndex =1
                    Name ="fldTot"
                    ControlSource ="=fmtPnt(nz([pt_cumulatief]),True)"
                End
                Begin TextBox
                    TextAlign =1
                    Left =480
                    Width =2061
                    FontSize =8
                    TabIndex =2
                    Name ="fldVereniging"
                    ControlSource ="PT_Vereniging"
                End
                Begin TextBox
                    TextAlign =1
                    Width =456
                    FontSize =8
                    TabIndex =3
                    Name ="fldTeller"
                    ControlSource ="=[pt_rankingDisplay]"
                End
                Begin TextBox
                    Visible = NotDefault
                    TextAlign =1
                    Left =2834
                    Width =531
                    FontSize =8
                    TabIndex =4
                    Name ="PT_N_Meetellende_zwemmers"
                    ControlSource ="PT_N_Meetellende_zwemmers"
                End
                Begin TextBox
                    Visible = NotDefault
                    TextAlign =1
                    Left =3666
                    Width =156
                    FontSize =8
                    TabIndex =5
                    Name ="t1"
                End
                Begin TextBox
                    Visible = NotDefault
                    TextAlign =1
                    Left =3968
                    Width =156
                    FontSize =8
                    TabIndex =6
                    Name ="t2"
                End
                Begin TextBox
                    Visible = NotDefault
                    TextAlign =1
                    Left =4271
                    Width =156
                    FontSize =8
                    TabIndex =7
                    Name ="t3"
                End
                Begin TextBox
                    Visible = NotDefault
                    TextAlign =1
                    Left =4535
                    Width =156
                    FontSize =8
                    TabIndex =8
                    Name ="t4"
                End
                Begin TextBox
                    Visible = NotDefault
                    TextAlign =1
                    Left =3742
                    Width =156
                    FontSize =8
                    TabIndex =9
                    Name ="p1"
                End
                Begin TextBox
                    Visible = NotDefault
                    TextAlign =1
                    Left =4044
                    Width =156
                    FontSize =8
                    TabIndex =10
                    Name ="p2"
                End
                Begin TextBox
                    Visible = NotDefault
                    TextAlign =1
                    Left =4347
                    Width =156
                    FontSize =8
                    TabIndex =11
                    Name ="p3"
                End
                Begin TextBox
                    Visible = NotDefault
                    TextAlign =1
                    Left =4611
                    Width =156
                    FontSize =8
                    TabIndex =12
                    Name ="p4"
                End
                Begin TextBox
                    Visible = NotDefault
                    TextAlign =1
                    Left =3855
                    Width =156
                    FontSize =8
                    TabIndex =13
                    Name ="d1"
                End
                Begin TextBox
                    Visible = NotDefault
                    TextAlign =1
                    Left =4157
                    Width =156
                    FontSize =8
                    TabIndex =14
                    Name ="d2"
                End
                Begin TextBox
                    Visible = NotDefault
                    TextAlign =1
                    Left =4460
                    Width =156
                    FontSize =8
                    TabIndex =15
                    Name ="d3"
                End
                Begin TextBox
                    Visible = NotDefault
                    TextAlign =1
                    Left =4724
                    Width =156
                    FontSize =8
                    TabIndex =16
                    Name ="d4"
                End
                Begin TextBox
                    Visible = NotDefault
                    TextAlign =1
                    Left =4951
                    Width =321
                    FontSize =8
                    TabIndex =17
                    Name ="ft1"
                End
                Begin TextBox
                    Visible = NotDefault
                    TextAlign =1
                    Left =5254
                    Width =321
                    FontSize =8
                    TabIndex =18
                    Name ="ft2"
                End
                Begin TextBox
                    Visible = NotDefault
                    TextAlign =1
                    Left =5594
                    Width =321
                    FontSize =8
                    TabIndex =19
                    Name ="ft3"
                End
                Begin TextBox
                    Visible = NotDefault
                    TextAlign =1
                    Left =5972
                    Width =321
                    FontSize =8
                    TabIndex =20
                    Name ="ft4"
                End
                Begin TextBox
                    Visible = NotDefault
                    TextAlign =1
                    Left =5027
                    Width =321
                    FontSize =8
                    TabIndex =21
                    Name ="fp1"
                End
                Begin TextBox
                    Visible = NotDefault
                    TextAlign =1
                    Left =5330
                    Width =321
                    FontSize =8
                    TabIndex =22
                    Name ="fp2"
                End
                Begin TextBox
                    Visible = NotDefault
                    TextAlign =1
                    Left =5670
                    Width =321
                    FontSize =8
                    TabIndex =23
                    Name ="fp3"
                End
                Begin TextBox
                    Visible = NotDefault
                    TextAlign =1
                    Left =6048
                    Width =321
                    FontSize =8
                    TabIndex =24
                    Name ="fp4"
                End
                Begin TextBox
                    Visible = NotDefault
                    TextAlign =1
                    Left =5103
                    Width =321
                    FontSize =8
                    TabIndex =25
                    Name ="fnm1"
                End
                Begin TextBox
                    Visible = NotDefault
                    TextAlign =1
                    Left =5406
                    Width =321
                    FontSize =8
                    TabIndex =26
                    Name ="fnm2"
                End
                Begin TextBox
                    Visible = NotDefault
                    TextAlign =1
                    Left =5746
                    Width =321
                    FontSize =8
                    TabIndex =27
                    Name ="fnm3"
                End
                Begin TextBox
                    Visible = NotDefault
                    TextAlign =1
                    Left =6124
                    Width =321
                    FontSize =8
                    TabIndex =28
                    Name ="fnm4"
                End
                Begin TextBox
                    Visible = NotDefault
                    TextAlign =1
                    Left =5178
                    Width =321
                    FontSize =8
                    TabIndex =29
                    Name ="fest1"
                End
                Begin TextBox
                    Visible = NotDefault
                    TextAlign =1
                    Left =5481
                    Width =321
                    FontSize =8
                    TabIndex =30
                    Name ="fest2"
                End
                Begin TextBox
                    Visible = NotDefault
                    TextAlign =1
                    Left =5821
                    Width =321
                    FontSize =8
                    TabIndex =31
                    Name ="fest3"
                End
                Begin TextBox
                    Visible = NotDefault
                    TextAlign =1
                    Left =6199
                    Width =321
                    FontSize =8
                    TabIndex =32
                    Name ="fest4"
                End
                Begin TextBox
                    Visible = NotDefault
                    TextAlign =1
                    Left =6614
                    Width =321
                    FontSize =8
                    TabIndex =33
                    Name ="fIsV1"
                End
                Begin TextBox
                    Visible = NotDefault
                    TextAlign =1
                    Left =6765
                    Width =321
                    FontSize =8
                    TabIndex =34
                    Name ="fIsV2"
                End
                Begin TextBox
                    Visible = NotDefault
                    TextAlign =1
                    Left =6841
                    Width =321
                    FontSize =8
                    TabIndex =35
                    Name ="fIsV3"
                End
                Begin TextBox
                    Visible = NotDefault
                    TextAlign =1
                    Left =6917
                    Width =321
                    FontSize =8
                    TabIndex =36
                    Name ="fIsV4"
                End
                Begin TextBox
                    Visible = NotDefault
                    TextAlign =1
                    Left =7143
                    Width =321
                    FontSize =8
                    TabIndex =37
                    Name ="fIsD1"
                End
                Begin TextBox
                    Visible = NotDefault
                    TextAlign =1
                    Left =7256
                    Width =321
                    FontSize =8
                    TabIndex =38
                    Name ="fIsD2"
                End
                Begin TextBox
                    Visible = NotDefault
                    TextAlign =1
                    Left =7332
                    Width =321
                    FontSize =8
                    TabIndex =39
                    Name ="fIsD3"
                End
                Begin TextBox
                    Visible = NotDefault
                    TextAlign =1
                    Left =7445
                    Width =321
                    FontSize =8
                    TabIndex =40
                    Name ="fIsD4"
                End
                Begin TextBox
                    Visible = NotDefault
                    Left =8239
                    Width =276
                    TabIndex =41
                    Name ="PT_Cumulatief"
                    ControlSource ="PT_Cumulatief"
                    GUID = Begin
                        0x3de4f1ffe107c742b29f5bddcd393d0e
                    End
                End
                Begin TextBox
                    TextAlign =1
                    Left =9645
                    Width =300
                    FontSize =8
                    TabIndex =42
                    Name ="fldTotGold"
                    GUID = Begin
                        0xe100bf9f87524e40af6d0d89ca8bf688
                    End
                End
                Begin TextBox
                    TextAlign =1
                    Left =10050
                    Width =300
                    FontSize =8
                    TabIndex =43
                    Name ="fldTotSilver"
                    GUID = Begin
                        0x8e29d458bca1364c852c4d221fd4f7ab
                    End
                End
                Begin TextBox
                    TextAlign =1
                    Left =10465
                    Width =300
                    FontSize =8
                    TabIndex =44
                    Name ="fldTotBronze"
                    GUID = Begin
                        0x87dc0260ef979c47bd6f8570732d3929
                    End
                End
                Begin TextBox
                    Visible = NotDefault
                    IMESentenceMode =3
                    Left =7937
                    Width =261
                    TabIndex =45
                    Name ="PT_Subtotaal"
                    ControlSource ="PT_Subtotaal"
                    GUID = Begin
                        0x42a88b7021134b4e876e527a9702f516
                    End
                End
                Begin TextBox
                    Visible = NotDefault
                    IMESentenceMode =3
                    Left =8579
                    Width =321
                    TabIndex =46
                    Name ="PT_RankingDisplay"
                    ControlSource ="PT_RankingDisplay"
                    GUID = Begin
                        0xb4edb4cb81b5484d9812d90324fd300f
                    End
                End
                Begin TextBox
                    Visible = NotDefault
                    IMESentenceMode =3
                    Left =8881
                    Width =321
                    TabIndex =47
                    Name ="PT_Ranking"
                    ControlSource ="PT_Ranking"
                    GUID = Begin
                        0x0990a2fec1a04f42b3e2ee42bf54dcc6
                    End
                End
            End
        End
        Begin BreakFooter
            KeepTogether = NotDefault
            Height =0
            BreakLevel =5
            Name ="scCatFooter"
        End
        Begin BreakFooter
            KeepTogether = NotDefault
            Height =0
            BreakLevel =3
            Name ="scProgFooter"
        End
        Begin PageFooter
            Height =256
            OnFormat ="[Event Procedure]"
            Name ="scPageFooter"
            Begin
                Begin TextBox
                    TextAlign =3
                    Left =8503
                    Width =2106
                    Height =256
                    FontSize =8
                    FontWeight =700
                    Name ="Field38"
                    ControlSource ="=\"Pagina \" & [Page] & \"/\" & [Pages]"
                End
                Begin Label
                    TextAlign =2
                    Left =7355
                    Width =825
                    Height =240
                    FontSize =8
                    FontWeight =700
                    Name ="fldAppName"
                    Caption ="Hupprog"
                End
                Begin TextBox
                    TextAlign =1
                    Width =7011
                    Height =256
                    FontSize =8
                    FontWeight =700
                    TabIndex =1
                    Name ="fldFooter"
                End
            End
        End
        Begin FormFooter
            KeepTogether = NotDefault
            Height =0
            Name ="scRepFooter"
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False

Option Compare Database   'Use database order for string comparisons
Option Explicit

Private lastWedNr As Long
Private lastProg As String
Private lastPntGrpCatIdx As Integer
Private lastPntGrpABC As String


Private wedInfo As WED_BASIC_INFO
Private pntInfo As PNT_GLOBAL_BASIC_INFO
Private pntCalcMode As Integer
Private pntVerPntOpts As PNT_VER_PNT_OPTIONS
Private pntVerSecOpts As PNT_VER_SEC_OPTIONS
Private pntVerMedOpts As PNT_VER_MED_OPTIONS
Private nDisplayComp As Integer
Private blDisplayNaam As Boolean
Private blHideZero As Boolean
Private blHideEmptySubtotals As Boolean
Private blIsSmall As Boolean
Private blIsEindUitslag As Boolean



Private Function rpcIsSmall() As Boolean
rpcIsSmall = False
End Function




'below is standard stuff

Private Sub Report_Open(Cancel As Integer)
On Error Resume Next
initReport
End Sub

Private Sub scCatHeader_Format(Cancel As Integer, FormatCount As Integer)
On Error Resume Next
If blIsEindUitslag Then
  Cancel = True
End If
End Sub

Private Sub scDetail_Format(Cancel As Integer, FormatCount As Integer)
On Error GoTo fout

If Nz(Me.PT_Cumulatief) < 1 Then
  If (blHideZero) Then
    Cancel = True
    Exit Sub
  End If
End If


Dim blIsInit As Boolean
blIsInit = Nz(Me.PT_Is_InitVals)


If blHideEmptySubtotals And (Not blIsEindUitslag) Then
  Dim blIsLastProg As Boolean
  blIsLastProg = True
  
  Dim tpWed As Long, tpProg As String, tpCatIdx As Integer, tpABC As String
  tpWed = Nz(Me.PT_Wedstrijdnummer)
  tpProg = Nz(Me.PT_Programmanummer)
  tpCatIdx = Nz(Me.PT_PNT_GRP_CatIdx)
  tpABC = Nz(Me.PT_PNT_GRP_ABC)
  If (tpWed <> lastWedNr) Or (tpProg <> lastProg) Or (tpCatIdx <> lastPntGrpCatIdx) Or (tpABC <> lastPntGrpABC) Then
    blIsLastProg = False
  End If
  
  If (blIsLastProg) Then
    Me.fldTeller.value = Nz(Me.PT_RankingDisplay)
  ElseIf (blIsInit) Then
    Me.fldTeller.value = Nz(Me.PT_RankingDisplay)
  Else
    If (Nz(Me.PT_Subtotaal) < 1) Then
      Cancel = True
      Exit Sub
    Else
      Me.fldTeller.value = Nz(Me.PT_Ranking)
    End If
  End If
End If



'If Me.fldTeller.value > 50000 Then
'  Me.fldTeller.Visible = False
'Else
'  Me.fldTeller.Visible = True
'End If


Dim i As Integer


If (Not blIsSmall) Then

  'hide everything
  For i = 1 To nDisplayComp
    Me.Controls("t" & i).Visible = (Not blIsEindUitslag) And (Not blIsInit)
    Me.Controls("p" & i).Visible = (Not blIsEindUitslag) And (Not blIsInit)
    If (blDisplayNaam) Then
      Me.Controls("d" & i).Visible = (Not blIsEindUitslag) And (Not blIsInit)
    End If
  Next i
  
End If



If (Not blIsSmall) And (Not blIsEindUitslag) Then


  Dim tpProgType As String
  tpProgType = Nz(Me.Controls("PT_Type").value)

  For i = 1 To nDisplayComp
    Dim tpTijd As Double
    Dim tpPnt As Double
    Dim tpEst As Integer
    Dim tpNm As String
    Dim tpIsVVT As Boolean
    Dim tpIsDis As Boolean
  
    tpTijd = Nz(Me.Controls("ft" & i).value)
    tpPnt = Nz(Me.Controls("fp" & i).value)
    tpNm = Nz(Me.Controls("fnm" & i).value)
    tpEst = Nz(Me.Controls("fest" & i).value)
  
    tpIsVVT = Nz(Me.Controls("fIsV" & i).value)
    tpIsDis = Nz(Me.Controls("fIsD" & i).value)
  
  
    If (tpProgType = PROG_TYPE_PUNT) Then
      Me.Controls("t" & i).value = fmtPnt(Abs(tpTijd), True)
    Else
      Me.Controls("t" & i).value = pntDisplayTijd(tpTijd, tpIsVVT, tpIsDis)
    End If
    
    If (pntInfo.type = PNT_TYPE_VER_MED) Then
      If (tpPnt >= 1000000 - 0.0001) Then
        Me.Controls("p" & i).value = "G"
      ElseIf (tpPnt >= 1000 - 0.0001) Then
        Me.Controls("p" & i).value = "Z"
      ElseIf (tpPnt >= 1 - 0.0001) Then
        Me.Controls("p" & i).value = "B"
      Else
        Me.Controls("p" & i).value = ""
      End If
    Else
      Me.Controls("p" & i).value = fmtPnt(tpPnt, True)
    End If
  
    If (blDisplayNaam) Then
      If (Nz(Me.PT_Is_Estaf)) Then
        If (tpEst > 0) Then
          Me.Controls("d" & i).value = Me.fldVereniging.value & " " & tpEst
        Else
          Me.Controls("d" & i).value = ""
        End If
      Else
        Me.Controls("d" & i).value = tpNm
      End If
    End If
  
  Next i
  
End If 'if not blSmall

If (pntInfo.type = PNT_TYPE_VER_MED) Then

  Dim nGold As Long, nSilver As Long, nBronze As Long
  Dim lTotPoints As Double
  lTotPoints = CLng(Nz(Me.PT_Cumulatief, 0))
  
  nGold = lTotPoints \ 1000000
  lTotPoints = lTotPoints Mod 1000000
  
  nSilver = lTotPoints \ 1000
  lTotPoints = lTotPoints Mod 1000
  
  nBronze = lTotPoints
  
  Me.fldTotGold.value = nGold
  Me.fldTotSilver.value = nSilver
  Me.fldTotBronze.value = nBronze
  
  
  If (blIsSmall) Then
    lTotPoints = CLng(Nz(Me.PT_Subtotaal, 0))
    
    nGold = lTotPoints \ 1000000
    lTotPoints = lTotPoints Mod 1000000
  
    nSilver = lTotPoints \ 1000
    lTotPoints = lTotPoints Mod 1000
  
    nBronze = lTotPoints
    
    Dim sSubTxt As String
    sSubTxt = ""
    
    If (nGold > 1) Then
      sSubTxt = nGold & " G, "
    ElseIf (nGold > 0) Then
      sSubTxt = "G, "
    End If
    
    If (nSilver > 1) Then
      sSubTxt = sSubTxt & nSilver & " Z, "
    ElseIf (nSilver > 0) Then
      sSubTxt = sSubTxt & "Z, "
    End If
    
    If (nBronze > 1) Then
      sSubTxt = sSubTxt & nBronze & " B, "
    ElseIf (nBronze > 0) Then
      sSubTxt = sSubTxt & "B, "
    End If
    
    If (Len(sSubTxt) > 0) Then
      sSubTxt = Left(sSubTxt, Len(sSubTxt) - 2)
    End If
    
    Me.fldSubTot.value = sSubTxt
      
  End If

End If





If (pntInfo.type = PNT_TYPE_VER_MED) Then
  If (blIsSmall) Then
    Me.fldSubTot.Visible = (Not blIsInit) And (Not blIsEindUitslag)
  Else
    Me.fldSubTot.Visible = False
  End If
Else
  Me.fldSubTot.Visible = (Not blIsInit) And (Not blIsEindUitslag)
End If

Exit Sub
fout:
MsgBox Err & " scDetail_format" & vbCrLf & Error$, 16
Exit Sub


'debug
On Error GoTo 0
Resume

End Sub



Private Sub scPageFooter_Format(Cancel As Integer, FormatCount As Integer)
On Error Resume Next
If (wedInfo.isMeet) And (pntInfo.blEntireMeet) Then
  If (wedInfo.meetMinDate <> wedInfo.meetMaxDate) Then
    Me.fldFooter = wedInfo.meetDes & ", " & rxpFormatDateNL(wedInfo.meetMinDate) & " t/m " & rxpFormatDateNL(wedInfo.meetMaxDate) & " te " & wedInfo.Plaats
  Else
    Me.fldFooter = wedInfo.meetDes & ", " & rxpFormatDateNL(wedInfo.date) & " te " & wedInfo.Plaats
  End If
Else
  Me.fldFooter = wedInfo.des & ", " & rxpFormatDateNL(wedInfo.date) & " te " & wedInfo.Plaats
End If

Me.fldAppName = appGetName()
End Sub

Private Sub scProgHeader_Format(Cancel As Integer, FormatCount As Integer)
On Error Resume Next
Dim blIsInit As Boolean
blIsInit = Nz(Me.PT_Is_InitVals)

Dim i As Integer
If (Not blIsSmall) Then
  For i = 1 To nDisplayComp
    Me.Controls("lbT" & i).Visible = (Not blIsInit) And (Not blIsEindUitslag)
    If (pntInfo.type = PNT_TYPE_VER_MED) Then
      Me.Controls("lbP" & i).Visible = False
    Else
      Me.Controls("lbP" & i).Visible = (Not blIsInit) And (Not blIsEindUitslag)
    End If
  Next i
End If




If (pntInfo.type = PNT_TYPE_VER_MED) Then
  If (blIsSmall) Then
    Me.lbST.Visible = (Not blIsInit) And (Not blIsEindUitslag)
  Else
    Me.lbST.Visible = False
  End If
Else
  Me.lbST.Visible = (Not blIsInit) And (Not blIsEindUitslag)
End If


Me.lbTussenstand.Visible = blIsInit
Me.fldProgDes.Visible = (Not blIsInit) And (Not blIsEindUitslag)



  
End Sub


Private Sub initReport()
On Error GoTo fout


blIsSmall = rpcIsSmall()

Dim wednr As Long
Dim pntOrderID As Long

Dim maxNComp As Integer


Dim optProgSingle As String
Dim optProgStart As String
Dim optProgEnd As String
Dim optIsEindUitslag As Boolean
Dim optVerSingle As String

wednr = Nz(DLookup("PT_PNT_Wedstrijdnummer", "__punten_Stats"))
pntOrderID = Nz(DLookup("PT_PNT_OrderID", "__punten_Stats"))
pntCalcMode = Nz(DLookup("PT_PNT_CalcMode", "__punten_Stats"))

lastWedNr = Nz(DLookup("PT_LAST_WEdstrijdnummer", "__punten_Stats"))
lastProg = Nz(DLookup("PT_Last_Programmanummer", "__punten_Stats"))
lastPntGrpABC = Nz(DLookup("PT_LAST_PNT_GRP_ABC", "__punten_stats"))
lastPntGrpCatIdx = Nz(DLookup("PT_LAST_PNT_GRP_CatIdx", "__punten_stats"))

maxNComp = Nz(DLookup("PT_Max_NComp", "__punten_Stats"))

optIsEindUitslag = Nz(DLookup("PT_OPT_IsEindUitslag", "__punten_Stats"))
optProgSingle = Nz(DLookup("PT_OPT_ProgSingle", "__punten_Stats"))
optProgStart = Nz(DLookup("PT_OPT_ProgStart", "__punten_Stats"))
optProgEnd = Nz(DLookup("PT_OPT_ProgEnd", "__punten_Stats"))
optVerSingle = Nz(DLookup("PT_OPT_VerSingle", "__punten_stats"))


blHideEmptySubtotals = Nz(DLookup("PT_OPT_HideEmptySubtotals", "__punten_stats"))




Dim sqlWhereClause As String
sqlWhereClause = ""

If (optIsEindUitslag) Then
  blIsEindUitslag = True
  sqlWhereClause = "WHERE pt_programmanummer = """ & lastProg & """ and pt_wedstrijdnummer = " & lastWedNr & " and pt_pnt_grp_CatIdx =" & lastPntGrpCatIdx
  If (lastPntGrpABC = "") Then
    sqlWhereClause = sqlWhereClause & " and pt_pnt_grp_abc is null"
  Else
    sqlWhereClause = sqlWhereClause & " and pt_pnt_grp_abc =""" & lastPntGrpABC & """"
  End If
ElseIf (optProgSingle <> "") Then
  sqlWhereClause = "Where pt_programmanummer = """ & optProgSingle & """"
ElseIf (optProgStart <> "") Or (optProgEnd <> "") Then
  'range
  Dim stProg As Long
  Dim endprog As Long
  stProg = -9999
  endprog = 1000000
  If (optProgStart <> "") Then
    stProg = val(optProgStart)
  End If
  
  If (optProgEnd <> "") Then
    endprog = val(optProgEnd)
  End If
  
  sqlWhereClause = "WHERE Val([pt_programmanummer]) Between " & stProg & " and " & endprog
End If

If (optVerSingle <> "") Then
  If (sqlWhereClause <> "") Then
    sqlWhereClause = sqlWhereClause & " and "
  Else
    sqlWhereClause = "Where "
  End If
  
  sqlWhereClause = sqlWhereClause & " pt_vereniging =""" & optVerSingle & """"
End If

Dim sql As String
sql = "SELECT * FROM __punten " & _
      sqlWhereClause & " " & _
     "ORDER BY pt_wedstrijdnummer, Val([pt_programmanummer]), PT_Programmanummer"
     

Me.RecordSource = sql



Dim isFnd As Boolean

If Not wedLookup(wednr, isFnd, wedInfo) Then
  Exit Sub
End If

If Not isFnd Then
  Err.Raise 1, , "Kon wedstrijd: " & wednr & " niet vinden."
End If


If Not pntGlobalLookup(wednr, pntOrderID, isFnd, pntInfo) Then
  Exit Sub
End If

If (Not isFnd) Then
  Err.Raise 1, , "Kon puntentelling: ( " & wednr & " , " & pntOrderID & " ) niet vinden."
End If


If (pntInfo.type = PNT_TYPE_VER_PNT) Then
  If Not pntVerPntLookup(wednr, pntOrderID, isFnd, pntVerPntOpts) Then
    Exit Sub
  End If
ElseIf (pntInfo.type = PNT_TYPE_VER_SEC) Then
  If Not pntVerSecLookup(wednr, pntOrderID, isFnd, pntVerSecOpts) Then
    Exit Sub
  End If
ElseIf (pntInfo.type = PNT_TYPE_VER_MED) Then
  If Not pntVerMedLookup(wednr, pntOrderID, isFnd, pntVerMedOpts) Then
    Exit Sub
  End If
End If

If (Not isFnd) Then
  Err.Raise 1, , "Kon puntentelling: ( " & wednr & " , " & pntOrderID & " ) niet vinden."
End If






If (Not blIsEindUitslag) And blHideEmptySubtotals Then
  Me.fldTeller.ControlSource = ""
End If




If (pntInfo.type = PNT_TYPE_VER_MED) Then
  nDisplayComp = 3
  blDisplayNaam = True
Else
  nDisplayComp = maxNComp
  If (nDisplayComp > 4) Then
    nDisplayComp = 4
  End If
  
  If (nDisplayComp < 1) Then
    nDisplayComp = 1
  End If

  
  blDisplayNaam = True
  If (nDisplayComp > 2) Then
    blDisplayNaam = False
  End If
  
End If



If Not blIsSmall Then
  Dim i As Integer
  For i = 1 To nDisplayComp
    Me.Controls("ft" & i).ControlSource = "PT_Actual_Tijd_" & i
    Me.Controls("fp" & i).ControlSource = "PT_Punten_" & i
    Me.Controls("fnm" & i).ControlSource = "PT_Naam_" & i
    Me.Controls("fest" & i).ControlSource = "PT_Estafettenummer_" & i
    Me.Controls("fIsV" & i).ControlSource = "PT_Is_VVT_" & i
    Me.Controls("fIsD" & i).ControlSource = "PT_Is_Dis_" & i
  Next i
End If
  




If Not blIsSmall Then
  'Have to set all the sizes.
  Dim links As Long
  links = CLng(4.5 * 567)
  
  Dim rechts As Long
  
  If (pntInfo.type = PNT_TYPE_VER_MED) Then
    rechts = CLng(16.8 * 567)
  Else
    rechts = CLng(16.1 * 567)
  End If
  

  Dim tpRoom As Long
  tpRoom = (rechts - links) \ nDisplayComp

  Dim tWidth As Long
  Dim pWidth As Long
  Dim nWidth As Long
  If (blDisplayNaam) Then
    If (pntInfo.type = PNT_TYPE_VER_MED) Then
      tWidth = CLng(tpRoom * 0.3) - 5
      pWidth = CLng(tpRoom * 0.1) - 5
      nWidth = CLng(tpRoom * 0.6) - 5
    Else
      tWidth = CLng(tpRoom * 0.3) - 5
      pWidth = CLng(tpRoom * 0.2) - 5
      nWidth = CLng(tpRoom * 0.5) - 5
    End If
  Else
   tWidth = CLng(tpRoom * 0.6) - 5
   pWidth = CLng(tpRoom * 0.4) - 5
  End If

  'Hide everything.
  For i = 1 To 4
    Me.Controls("t" & i).Visible = False
    Me.Controls("lbT" & i).Visible = False
    Me.Controls("p" & i).Visible = False
    Me.Controls("lbP" & i).Visible = False
    Me.Controls("d" & i).Visible = False
  Next i


  For i = 1 To nDisplayComp
    Dim tpLeft As Double
    tpLeft = links + (i - 1) * tpRoom
    Me.Controls("t" & i).Left = tpLeft
    Me.Controls("t" & i).Width = tWidth
    Me.Controls("t" & i).Visible = True
  
    Me.Controls("lbT" & i).Left = Me.Controls("t" & i).Left
    Me.Controls("lbT" & i).Width = Me.Controls("t" & i).Width
    Me.Controls("lbT" & i).Visible = True
  
    Me.Controls("p" & i).Left = tpLeft + tWidth
    Me.Controls("p" & i).Width = pWidth
    Me.Controls("p" & i).Visible = True
  
    Me.Controls("lbP" & i).Left = Me.Controls("p" & i).Left
    Me.Controls("lbP" & i).Width = Me.Controls("p" & i).Width
    Me.Controls("lbP" & i).Visible = True
  
  
    If (blDisplayNaam) Then
      Me.Controls("d" & i).Left = tpLeft + tWidth + pWidth
      Me.Controls("d" & i).Width = nWidth
      Me.Controls("d" & i).Visible = True
    End If
  Next i
End If 'if not blsmall






If (pntInfo.type = PNT_TYPE_VER_MED) Then
  Me.fldTot.Visible = False
  Me.lbTot.Visible = False
  
  Me.fldTotGold.Visible = True
  Me.fldTotSilver.Visible = True
  Me.fldTotBronze.Visible = True
  
  Me.lbTotGold.Visible = True
  Me.lbTotSilver.Visible = True
  Me.lbTotBronze.Visible = True
  
  If (Not blIsSmall) Then
  
    Me.Controls("lbT1").Width = 3 * Me.Controls("lbT1").Width
    Me.Controls("lbT2").Width = 3 * Me.Controls("lbT2").Width
    Me.Controls("lbT3").Width = 3 * Me.Controls("lbT3").Width
  
    Me.Controls("lbT1").Caption = "Medaille 1"
    Me.Controls("lbT2").Caption = "Medaille 2"
    Me.Controls("lbT3").Caption = "Medaille 3"
  End If
  
  
  If (blIsSmall) Then
    Me.fldSubTot.ControlSource = ""
    Me.lbST.Caption = "Med."
  End If
  
Else
  Me.fldTot.Visible = True
  Me.lbTot.Visible = True
  
  Me.fldTotGold.Visible = False
  Me.fldTotSilver.Visible = False
  Me.fldTotBronze.Visible = False
  
  Me.lbTotGold.Visible = False
  Me.lbTotSilver.Visible = False
  Me.lbTotBronze.Visible = False
End If


blHideZero = True


If (Not blIsSmall) And blIsEindUitslag Then
  Me.lbTot.Left = Me.lbTot.Left - 2 * 567
  Me.fldTot.Left = Me.lbTot.Left
  
  Me.lbTotGold.Left = Me.lbTotGold.Left - 2 * 567
  Me.lbTotSilver.Left = Me.lbTotSilver.Left - 2 * 567
  Me.lbTotBronze.Left = Me.lbTotBronze.Left - 2 * 567
  
  Me.fldTotGold.Left = Me.lbTotGold.Left
  Me.fldTotSilver.Left = Me.lbTotSilver.Left
  Me.fldTotBronze.Left = Me.lbTotBronze.Left
  
End If




If (db_narrow() Or ((nDisplayComp = 4) And Not blIsSmall)) Then
  Dim ctl As Control
  For Each ctl In Me.Section(acDetail).Controls
    ctl.FontName = "Arial Narrow"
  Next ctl
End If

Exit Sub
fout:
MsgBox Err & " initReport" & vbCrLf & Error$, 16
Exit Sub

'debug
On Error GoTo 0
Resume

End Sub

Private Sub scRepHeader_Format(Cancel As Integer, FormatCount As Integer)
On Error Resume Next
Dim sTitle As String
sTitle = pntInfo.des

If (pntCalcMode = PNT_CALC_MODE_ESTIMATE) Then
  sTitle = "( ! SCHATTING (via inschrijftijden) ! ) " & sTitle
ElseIf (pntCalcMode = PNT_CALC_MODE_TEST) Then
  sTitle = "( ! TEST (via inschrijftijden) ! ) " & sTitle
End If

Me.fldTitle.value = sTitle
End Sub