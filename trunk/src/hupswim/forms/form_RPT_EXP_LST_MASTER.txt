Version =20
VersionRequired =20
Checksum =-2063900110
Begin Form
    RecordSelectors = NotDefault
    MaxButton = NotDefault
    MinButton = NotDefault
    ControlBox = NotDefault
    AutoCenter = NotDefault
    NavigationButtons = NotDefault
    DefaultView =0
    ScrollBars =0
    BorderStyle =1
    Cycle =1
    GridX =15
    GridY =15
    Width =11910
    ItemSuffix =181
    Left =3570
    Top =945
    Right =15480
    Bottom =7905
    Toolbar ="gFrmToolbar"
    RecSrcDt = Begin
        0xd4d8e8f09d6de340
    End
    Caption ="Rapport export lijsten"
    OnCurrent ="[Event Procedure]"
    OnOpen ="[Event Procedure]"
    MenuBar ="gMnBasic"
    PrtMip = Begin
        0xa0050000a0050000a0050000a005000000000000201c0000e010000001000000 ,
        0x010000006801000000000000a10700000100000001000000
    End
    PrtDevMode = Begin
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x01042a019c005c0a53ef80010100010000000000640001000f00580202000100 ,
        0x5802030001004134000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000054070000 ,
        0x5052495600200000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000001800000000001027 ,
        0x1027102700001027000000000000000034a20a000000000000000100ff000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000050001000100000000000000 ,
        0x0100000001006cd8000000000000000000000000000000000000000000010000 ,
        0x000064000100bb02880400000000000000000000000000000000000000000000 ,
        0x00000000000000000000000006000000f5ffffff000000000000000000000000 ,
        0x00000000000000010000000041007200690061006c0000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x00000000000000000000000000000000ffffff00000001000000000000000000 ,
        0x0100000000000000010000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000700070000000000020000000100000005000000 ,
        0x0001ffff00000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x00000000000000000000000009000000fffffffffefffffffefffffffeffffff ,
        0xfefffffffefffffffefffffffefffffffefffffffefffffffefffffffeffffff ,
        0xfefffffffefffffffefffffffefffffffefffffffefffffffefffffffeffffff ,
        0xfeffffff09000000ffffffff0307090001000000000000000000000005000000 ,
        0x000000000000000007000000010000000000454e474c49534800000000000000 ,
        0x000042005200530050004c003000310041002e00450058004500000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x00004200520052004200410054004f004d005f00310032003300300000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x00006f00700074005f0031003200330030002e0069006e006900000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x000063006f0070005f0031003200330030002e0069006e006900000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x000048004c0031003200330069006e0069002e00640061007400000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x000048004c003100320033006400650066002e00640061007400000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x000000000000000000000000000000000000000042005200530050004c003000 ,
        0x310041002e004500580045000000000000000000000000000000000000000000 ,
        0x00000000000000000000000000000000000000000400e4030000000001000000 ,
        0x000000000100ffff000000000e01000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000c60088000000640000000000010100000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x00000000000000000000000000000000000000000000000006000000f5ffffff ,
        0x0000000000000000000000000000000000000001000000004100720069006100 ,
        0x6c00000000000000000000000000000000000000000000000000000000000000 ,
        0x00000000000000000000000000000000000000000000000000000000ffffff00 ,
        0x0100000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x00000000000000000000000000000000000000000000000000000000ffffffff ,
        0x6400000000000000000000800000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000100000000000000454f5343
    End
    PrtDevNames = Begin
        0x08001f0036000100000000000000000000000000000000000000000000000000 ,
        0x000000000000000000000000000000000000000000004c5054313a00
    End
    OnActivate ="[Event Procedure]"
    OnResize ="[Event Procedure]"
    Begin
        Begin Label
            BackStyle =0
        End
        Begin Rectangle
            Width =850
            Height =850
        End
        Begin CommandButton
            TextFontFamily =2
            Width =1701
            Height =283
        End
        Begin CheckBox
            SpecialEffect =2
            LabelX =230
            LabelY =-30
        End
        Begin OptionGroup
            Width =1701
            Height =1701
        End
        Begin TextBox
            Width =1701
            LabelX =-1701
        End
        Begin ComboBox
            Width =1701
            LabelX =-1701
        End
        Begin Subform
            SpecialEffect =2
            Width =1701
            Height =1701
        End
        Begin ToggleButton
            Width =283
            Height =283
            FontSize =8
            FontWeight =400
            ForeColor =-2147483630
            FontName ="MS Sans Serif"
        End
        Begin Tab
            Width =5103
            Height =3402
        End
        Begin Page
            Width =1701
            Height =1701
        End
        Begin FormHeader
            Height =1515
            BackColor =16776960
            Name ="Formheader"
            Begin
                Begin Rectangle
                    BackStyle =0
                    OverlapFlags =93
                    Top =566
                    Width =11558
                    Height =543
                    Name ="Box142"
                    GUID = Begin
                        0x446b8e03999c274ab65cc92e96611242
                    End
                End
                Begin Label
                    BackStyle =1
                    OverlapFlags =85
                    TextAlign =2
                    Left =3780
                    Top =120
                    Width =2955
                    Height =330
                    FontSize =12
                    FontWeight =700
                    BackColor =65280
                    Name ="Text1"
                    Caption ="Rapport Export Lijsten"
                    GUID = Begin
                        0xd471ae2302582049a11b93094c5ed7a5
                    End
                End
                Begin CommandButton
                    OverlapFlags =85
                    AccessKey =84
                    Left =10280
                    Top =113
                    Width =1140
                    Height =345
                    ForeColor =255
                    Name ="btnClose"
                    Caption ="&Terug"
                    OnClick ="[Event Procedure]"
                    GUID = Begin
                        0x7f6f73107a7b4745a9ce4a14867aa6a9
                    End
                End
                Begin TextBox
                    Enabled = NotDefault
                    Locked = NotDefault
                    OldBorderStyle =0
                    OverlapFlags =215
                    BackStyle =0
                    Left =1166
                    Top =717
                    Width =5766
                    FontWeight =700
                    TabIndex =1
                    Name ="fldRptSetDes"
                    GUID = Begin
                        0x1b9f99e83b4a3545a8210ac07f95a76f
                    End
                    Begin
                        Begin Label
                            OverlapFlags =215
                            Left =75
                            Top =720
                            Width =990
                            Height =240
                            Name ="Label104"
                            Caption ="Huidige lijst: "
                            GUID = Begin
                                0x90262d65f39c6d4d8682f4e78b7d1baf
                            End
                        End
                    End
                End
                Begin OptionGroup
                    OldBorderStyle =0
                    OverlapFlags =85
                    Top =1209
                    Width =11299
                    Height =306
                    TabIndex =2
                    BackColor =0
                    Name ="optView"
                    BeforeUpdate ="[Event Procedure]"
                    AfterUpdate ="[Event Procedure]"
                    DefaultValue ="1"
                    GUID = Begin
                        0x19291aaf61fd8747a74951f356650398
                    End
                    Begin
                        Begin ToggleButton
                            OverlapFlags =87
                            Left =1209
                            Top =1209
                            Width =1425
                            Height =300
                            OptionValue =1
                            Name ="optFTP"
                            Caption ="FTP Instellingen"
                            GUID = Begin
                                0x840bba9f288513469c269bc6707d5678
                            End
                        End
                        Begin ToggleButton
                            OverlapFlags =87
                            Left =8346
                            Top =1209
                            Width =1095
                            Height =300
                            OptionValue =5
                            Name ="optStats"
                            Caption ="Statistieken"
                            GUID = Begin
                                0x14961370f7531a4ca22b61e63c7dbb8e
                            End
                        End
                        Begin ToggleButton
                            OverlapFlags =87
                            Left =75
                            Top =1215
                            Width =1095
                            Height =300
                            OptionValue =0
                            Name ="optGlb"
                            Caption ="Instellingen"
                            GUID = Begin
                                0x1558a6b95b411f4d864245c43efd728e
                            End
                        End
                        Begin ToggleButton
                            OverlapFlags =87
                            Left =2796
                            Top =1215
                            Width =945
                            Height =300
                            OptionValue =2
                            Name ="optRec"
                            Caption ="Records"
                            GUID = Begin
                                0x1a7dbedb1a04394e9127502a4c752b95
                            End
                        End
                        Begin ToggleButton
                            OverlapFlags =87
                            Left =4093
                            Top =1215
                            Width =2205
                            Height =300
                            OptionValue =3
                            Name ="optWedOp"
                            Caption ="Wedstrijden - Opstellingen"
                            GUID = Begin
                                0xa705201a5826df4ea316d9b2b4ea962c
                            End
                        End
                        Begin ToggleButton
                            OverlapFlags =87
                            Left =6355
                            Top =1215
                            Width =1890
                            Height =300
                            OptionValue =4
                            Name ="optWedUit"
                            Caption ="Wedstrijden - Uitslagen"
                            GUID = Begin
                                0x2ef75d544d0c90459068a9c9062243ac
                            End
                        End
                    End
                End
                Begin CommandButton
                    OverlapFlags =215
                    AccessKey =90
                    TextFontFamily =34
                    Left =6992
                    Top =680
                    Width =675
                    Height =345
                    FontSize =8
                    TabIndex =3
                    Name ="btnZoekExpList"
                    Caption ="&Zoek"
                    OnClick ="[Event Procedure]"
                    FontName ="MS Sans Serif"
                    GUID = Begin
                        0xb0c8ecba6888d44091ae20f03a8266fb
                    End
                End
                Begin CommandButton
                    OverlapFlags =215
                    AccessKey =78
                    TextFontFamily =34
                    Left =7683
                    Top =680
                    Width =765
                    Height =345
                    FontSize =8
                    TabIndex =4
                    Name ="btnNieuw"
                    Caption ="&Nieuw"
                    OnClick ="[Event Procedure]"
                    FontName ="MS Sans Serif"
                    GUID = Begin
                        0x2dacf7a0c7a8524692325c7be6d2bdf4
                    End
                End
                Begin CommandButton
                    OverlapFlags =215
                    TextFontFamily =34
                    Left =8464
                    Top =680
                    Width =1095
                    Height =345
                    FontSize =8
                    TabIndex =5
                    Name ="btnVerwijder"
                    Caption ="Verwijder"
                    OnClick ="[Event Procedure]"
                    FontName ="MS Sans Serif"
                    GUID = Begin
                        0x60b316b18cb23d4788dad9f235d4a40c
                    End
                End
                Begin CommandButton
                    OverlapFlags =215
                    AccessKey =86
                    TextFontFamily =34
                    Left =9902
                    Top =680
                    Width =741
                    Height =343
                    FontSize =8
                    FontWeight =400
                    TabIndex =6
                    ForeColor =-2147483630
                    Name ="btnVorig"
                    Caption ="&Vorige"
                    OnClick ="[Event Procedure]"
                    FontName ="MS Sans Serif"
                    GUID = Begin
                        0xb877698554a0b8468cc5d0b746019dcf
                    End
                End
                Begin CommandButton
                    OverlapFlags =215
                    AccessKey =71
                    TextFontFamily =34
                    Left =10658
                    Top =680
                    Width =831
                    Height =343
                    FontSize =8
                    FontWeight =400
                    TabIndex =7
                    ForeColor =-2147483630
                    Name ="btnVolgend"
                    Caption ="Vol&gende"
                    OnClick ="[Event Procedure]"
                    FontName ="MS Sans Serif"
                    GUID = Begin
                        0x698c74c02d6b094b81ad9acedd4fa8f2
                    End
                End
            End
        End
        Begin Section
            CanGrow = NotDefault
            Height =4890
            BackColor =16776960
            Name ="Detail"
            Begin
                Begin Subform
                    OverlapFlags =215
                    Width =11616
                    Height =411
                    Name ="subfrm"
                    GUID = Begin
                        0xb04ee63339c9c34883b8064dbaf307b1
                    End
                End
                Begin Tab
                    Visible = NotDefault
                    OverlapFlags =93
                    Style =2
                    Width =11910
                    Height =1695
                    TabIndex =1
                    Name ="tabctl"
                    GUID = Begin
                        0xd7efc3d2a3300e4a8eafdd7e98f1fdba
                    End
                    Begin
                        Begin Page
                            OverlapFlags =223
                            Left =75
                            Top =75
                            Width =11760
                            Height =1545
                            Name ="Page18"
                            GUID = Begin
                                0xadd48a45adeb0441af49d1c68915c441
                            End
                        End
                        Begin Page
                            OverlapFlags =223
                            Left =75
                            Top =75
                            Width =11760
                            Height =1545
                            Name ="Page19"
                            GUID = Begin
                                0xd73d71a35103894dbbc518d1f7f270d7
                            End
                        End
                    End
                End
            End
        End
        Begin FormFooter
            Height =566
            BackColor =16776960
            Name ="FormFooter"
            Begin
                Begin CommandButton
                    OverlapFlags =85
                    AccessKey =68
                    Left =120
                    Top =120
                    Width =1251
                    Height =343
                    Name ="btnValidate"
                    Caption ="Vali&deer"
                    OnClick ="[Event Procedure]"
                    GUID = Begin
                        0x4d1c5bd803b8944da79e9c1b90ca7be8
                    End
                    UnicodeAccessKey =100
                End
                Begin CommandButton
                    OverlapFlags =85
                    AccessKey =69
                    Left =1518
                    Top =120
                    Width =2241
                    Height =343
                    TabIndex =1
                    Name ="btnExport"
                    Caption ="&Exporteer rapporten"
                    OnClick ="[Event Procedure]"
                    GUID = Begin
                        0xc7b52e5457300241ba54b4ce3aad0153
                    End
                    UnicodeAccessKey =69
                End
            End
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Compare Database   'Use database order for string comparisons
Option Explicit


Private Const PAGE_GLB = 0
Private Const PAGE_FTP = 1
Private Const PAGE_REC = 2
Private Const PAGE_WED_OP = 3
Private Const PAGE_WED_UIT = 4
Private Const PAGE_STATS = 5


Private Const PAGE_MIN = PAGE_GLB
Private Const PAGE_MAX = PAGE_STATS

Private gExpListName As String


'Inherited properties.
Private Const MAX_N_PAGES = 10
Private curPage As Integer
Private blPageChangeToCancel As Boolean




Public Sub notifyChange()
On Error GoTo fout


If Not rxlSaveExpList() Then
  Exit Sub
End If


If (gExpListName <> "") Then
  'May need to update name.
  Dim sCurName As String
  sCurName = Nz(DLookup("EL_Name", "hsoRptExpListCurGlbSettings"))
  
  If (sCurName <> gExpListName) Then
    gExpListName = sCurName
    Me.fldRptSetDes = gExpListName
    
    'Also need up to update structures
    rxlGenerateStructure
    
  End If
End If
Exit Sub
fout:
MsgBox Err & "  notifyChange" & vbCrLf & Error$, 16
Exit Sub
End Sub

Private Sub updateView()
On Error Resume Next


End Sub





Private Sub btnExport_Click()
On Error Resume Next
DoCmd.DoMenuItem A_FORMBAR, A_FILE, A_SAVERECORD, , A_MENU_VER20
If Not rxlProcessExpList() Then
  Exit Sub
End If
MsgBox "De rapporten zijn met succes geexporteerd.", vbInformation
End Sub

Private Sub btnNieuw_Click()
On Error Resume Next

If Not pvbAllowNewView() Then
  Exit Sub
End If

gExpListName = ""

'Need to prompt for a new name.
Dim sNewName As String, blIsOK As Boolean

If Not rxlCreateNew(blIsOK, sNewName) Then
  pvbNotifyNewView
  Exit Sub
End If

If (blIsOK) Then
  gExpListName = sNewName
End If

'whatever happens, a new view needs to be created
pvbNotifyNewView

End Sub





Private Sub btnValidate_Click()
On Error Resume Next
DoCmd.DoMenuItem A_FORMBAR, A_FILE, A_SAVERECORD, , A_MENU_VER20
If (gExpListName <> "") Then
  If Not rxlValidateExpList() Then
    Exit Sub
  End If
  MsgBox "Geen problemen gevonden met deze export-lijst", vbInformation
End If
End Sub

Private Sub btnVerwijder_Click()
On Error GoTo fout

If Not pvbAllowNewView() Then
  Exit Sub
End If

If (gExpListName = "") Then
  Exit Sub
End If

If (MsgBox("Weet u zeker dat u de export lijst " & vbCrLf & gExpListName & vbCrLf & "wilt verwijderen?", vbOKCancel + vbQuestion) = vbCancel) Then
  Exit Sub
End If

rxlDeleteExpList


gExpListName = ""

pvbNotifyNewView



Exit Sub
fout:
MsgBox Err & " btnVerwijder_Click" & vbCrLf & Error$, 16
Exit Sub
    
    
End Sub


Private Sub btnVolgend_Click()
On Error Resume Next
moveExpList 1
End Sub

Private Sub btnVorig_Click()
On Error Resume Next
moveExpList -1
End Sub








Private Sub Form_Activate()
On Error Resume Next
Me.OrderBy = ""

DoCmd.Maximize

End Sub















Private Sub moveExpList(direction As Integer)
On Error GoTo fout

If Not pvbAllowNewView() Then
  Exit Sub
End If

Dim isFnd As Boolean, sFndName As String, lFndObjID As Long
If (direction < 0) Then
  If Not rxlLookupPrevious(gExpListName, isFnd, sFndName, lFndObjID) Then
    Exit Sub
  End If
Else
  If Not rxlLookupNext(gExpListName, isFnd, sFndName, lFndObjID) Then
    Exit Sub
  End If
End If

If (isFnd) Then
  gExpListName = sFndName
    
  pvbNotifyNewView
End If

Exit Sub
fout:
MsgBox Err & " moveExpList" & vbCrLf & Error$, 16
Exit Sub
End Sub



Private Sub btnZoekExpList_Click()
On Error GoTo fout

Dim isOK As Boolean
Dim lkpExpList As String

If Not pvbAllowNewView() Then
  Exit Sub
End If

If Not rxlPromptUser(isOK, lkpExpList) Then
  Exit Sub
End If

If (isOK) Then

  
  gExpListName = lkpExpList
  

  pvbNotifyNewView
  
End If
  

  

Exit Sub
fout:
MsgBox Err & " btnZoekExpList_Click" & vbCrLf & Error$, 16
Exit Sub
    
End Sub




Private Function pvcMinPage() As Integer
On Error Resume Next
pvcMinPage = PAGE_MIN
End Function

Private Function pvcMaxPage() As Integer
On Error Resume Next
pvcMaxPage = PAGE_MAX
End Function



Private Sub pvcInitGlobal()
On Error GoTo fout



Exit Sub
fout:
MsgBox Err & " pvcInitGlobal" & vbCrLf & Error$, 16
Exit Sub


End Sub

Private Sub pvcNewViewInit()
On Error GoTo fout

rxlGenerateStructure

Me.fldRptSetDes = ""


If (gExpListName <> "") Then
  If Not rxlLoadExpList(gExpListName) Then
    Exit Sub
  End If
End If

Me.fldRptSetDes = gExpListName

Exit Sub
fout:
MsgBox Err & " pvcNewViewInit" & vbCrLf & Error$, 16
Exit Sub

End Sub

Private Sub pvcNewViewFirstPage(ByRef fstPage As Integer)
On Error Resume Next
fstPage = PAGE_GLB
End Sub
Private Sub pvcNewViewSetPages(ByRef pageVisible() As Boolean, ByRef pageCaption() As String, ByRef pageControls() As ToggleButton)
On Error GoTo fout
Dim i As Integer
For i = PAGE_MIN To PAGE_MAX

  Dim blVis As Boolean
  blVis = True
  Dim cntrl As ToggleButton
  Set cntrl = Nothing
  
    
  Select Case i
    Case PAGE_GLB
      Set cntrl = Me.optGlb
    Case PAGE_FTP
      Set cntrl = Me.optFTP
    Case PAGE_REC
      Set cntrl = Me.optRec
    Case PAGE_WED_OP
      Set cntrl = Me.optWedOp
    Case PAGE_WED_UIT
      Set cntrl = Me.optWedUit
    Case PAGE_STATS
      Set cntrl = Me.optStats
  End Select
  

  Set pageControls(i) = cntrl
  pageCaption(i) = cntrl.Caption
  pageVisible(i) = blVis
  
Next i

Exit Sub
fout:
MsgBox Err & " pvcNewViewSetPages" & vbCrLf & Error$, 16
Exit Sub

'debug
On Error GoTo 0
Resume
End Sub




Private Sub pvcPerformClose(lstPage As Integer)
On Error Resume Next
End Sub


Private Sub pvcHandleMove(ByVal prvPage As Integer, ByRef nxtPage As Integer)
On Error GoTo fout

Exit Sub
fout:
MsgBox Err & " " & Error$, 16
End Sub


Private Sub pvcPrePageLoad(ByVal curPage As Integer, ByRef Cancel As Boolean)
On Error GoTo fout

Dim sql As String

Cancel = True


Cancel = False
Exit Sub

fout:
MsgBox Err & " pvcPrePageLoad" & vbCrLf & Error$, 16
Exit Sub
End Sub
Private Sub pvcPostPageLoad(ByVal curPage As Integer)
On Error Resume Next
Select Case curPage
      
End Select
End Sub

Private Function pvcGetPage(ByVal curPage As Integer, ByRef isSubfrm As Boolean, subfrmName As String, ByRef pg As page)
On Error Resume Next

Dim subName As String
subName = ""

Dim isSub As Boolean
isSub = False


If (gExpListName <> "") Then
  
  Select Case curPage
    Case PAGE_GLB
      isSub = True
      subName = "RPT_EXP_LST_Settings"
    Case PAGE_FTP
      isSub = True
      subName = "RPT_EXP_LST_FTP"
    Case PAGE_REC
      isSub = True
      subName = "RPT_EXP_LST_Recs"
    Case PAGE_WED_OP
      isSub = True
      subName = "RPT_EXP_LST_Wed_ops"
    Case PAGE_WED_UIT
      isSub = True
      subName = "RPT_EXP_LST_Wed_uit"
    Case PAGE_STATS
      isSub = True
      subName = "RPT_EXP_LST_Stats"
  End Select
  
  If (isSub) Then
    subfrmName = subName
    isSubfrm = True
  Else
    isSubfrm = False
  End If
  
Else
  subfrmName = "WIZ_UNBOUND"
  isSubfrm = True
End If

End Function




Private Sub pvcPrePageUnload(pageNr As Integer)
On Error Resume Next



End Sub

Private Sub pvcPostPageUnload(pageNr As Integer)
On Error Resume Next


End Sub



Private Function pvcAllowExitPage(pageNr As Integer) As Boolean
On Error Resume Next
pvcAllowExitPage = False


pvcAllowExitPage = True
End Function


'==========================================================
'Below is just standard wizard stuff.
'==========================================================
Public Function pvbAllowNewView() As Boolean
On Error GoTo fout
pvbAllowNewView = False

On Error Resume Next
DoCmd.DoMenuItem A_FORMBAR, A_FILE, A_SAVERECORD, , A_MENU_VER20
On Error GoTo fout

If (curPage <> -1) Then
  If Not pvbAllowExitPage() Then
    Exit Function
  End If
End If

pvbAllowNewView = True
Exit Function
fout:
MsgBox Err & " pvbAllowNewView" & vbCrLf & Error$, 16
Exit Function
End Function

Private Sub pvbNotifyNewView()
On Error Resume Next

Dim lastOpenPage As Integer
lastOpenPage = curPage

pvbUnloadPage


pvcNewViewInit

Dim pageVisible(0 To MAX_N_PAGES) As Boolean
Dim pageCaption(0 To MAX_N_PAGES) As String
Dim pageControl(0 To MAX_N_PAGES) As ToggleButton

Dim minPage As Integer
Dim maxPage As Integer
minPage = pvcMinPage()
maxPage = pvcMaxPage()

If (minPage < 0) Then
  minPage = 0
End If

If (maxPage > MAX_N_PAGES) Then
  maxPage = MAX_N_PAGES
End If

Dim i As Integer
For i = minPage To maxPage
  pageVisible(i) = False
  pageCaption(i) = ""
Next i

pvcNewViewSetPages pageVisible, pageCaption, pageControl

Dim firstVisPage As Integer
firstVisPage = -1
For i = minPage To maxPage
  If (pageVisible(i)) Then
    firstVisPage = i
    Exit For
  End If
Next i

curPage = lastOpenPage

If (curPage < minPage Or curPage > maxPage) Then
  curPage = firstVisPage
Else
  If Not pageVisible(curPage) Then
    curPage = firstVisPage
  End If
End If

pvcNewViewFirstPage curPage

If (curPage < minPage) Or (curPage > maxPage) Then
  curPage = -1
ElseIf Not pageVisible(curPage) Then
  curPage = -1
End If

If (curPage = -1) Then
  curPage = firstVisPage
End If


pvbFormatPages pageVisible, pageCaption, pageControl

pvbSelCurPage

pvbDisplayCurPage



End Sub

'make sure that all visible tabs are displayed, with the proper captions.
Private Sub pvbFormatPages(ByRef pageVisible() As Boolean, ByRef pageCaption() As String, ByRef pageControl() As ToggleButton)
On Error GoTo fout

Dim minPage As Integer
Dim maxPage As Integer

minPage = pvcMinPage()
maxPage = pvcMaxPage()

Dim curLeft As Long
curLeft = optView.Left

Dim i As Integer
For i = minPage To maxPage
  pageControl(i).Visible = pageVisible(i)
  pageControl(i).Caption = pageCaption(i)
  If (pageVisible(i)) Then
    pageControl(i).Left = curLeft
    curLeft = curLeft + pageControl(i).Width + 0.1 * 567
  End If
Next i


Exit Sub
fout:
MsgBox Err & " pvbFormatPages" & vbCrLf & Error$, 16
Exit Sub
End Sub

Private Sub pvbSelCurPage()
On Error Resume Next
If (curPage <> -1) Then
  optView.value = curPage
Else
  optView.value = Null
End If

End Sub

Private Sub pvbMoveToPage(newPage As Integer)
On Error GoTo fout

Dim oldPage As Integer
oldPage = curPage

If (newPage <> oldPage) Then
  pvbUnloadPage

  pvcHandleMove oldPage, newPage
    
  curPage = newPage
  
  pvbSelCurPage
  
  pvbDisplayCurPage
    
End If
  

Exit Sub
fout:
MsgBox Err & " pvbMoveToPage" & vbCrLf & Error$, 16
Exit Sub
End Sub


Private Function pvbClose() As Boolean
On Error GoTo fout

pvbClose = False

Dim lstPage As Integer
lstPage = curPage


If Not pvbAllowExitPage() Then
  Exit Function
End If


pvbUnloadPage


pvcPerformClose lstPage
 
pvbClose = True
 
Exit Function
fout:
 MsgBox Err & " " & Error$, 16
 Exit Function


End Function





Private Sub btnClose_Click()
On Error Resume Next

If (pvbClose()) Then
  DoCmd.Close
End If

End Sub





Private Sub pvbInit()
On Error Resume Next

pvcInitGlobal

curPage = -1

pvbNotifyNewView

End Sub


Private Sub pvbDisplayCurPage()
On Error GoTo fout


If (curPage = -1) Then
  Me.tabctl.Visible = False
  Me.subfrm.Visible = True
  
  
  Me.subfrm.SourceObject = "WIZ_UNBOUND"
  
  Me.subfrm.SetFocus
Else

  Dim blCancel As Boolean
  
  
  DoCmd.DoMenuItem A_FORMBAR, A_FILE, A_SAVERECORD, , A_MENU_VER20
  

  pvcPrePageLoad curPage, blCancel
    
  Dim pageName As String
  pageName = ""
  
  
  Dim tbPage As page
  Dim isSubfrm As Boolean
  
  
  
  If (Not blCancel) Then
    pvcGetPage curPage, isSubfrm, pageName, tbPage
  End If
    
  If (isSubfrm) Then
    
    Me.tabctl.Visible = False
    Me.subfrm.Visible = True
    
    If (pageName = "") Then
      pageName = "WIZ_UNBOUND"
    End If
    
    Me.subfrm.SourceObject = pageName
    
    pvcPostPageLoad curPage
    
    Me.subfrm.SetFocus
 
  Else
    Me.subfrm.Visible = False
    Me.tabctl.Visible = True
    Me.tabctl.value = tbPage.PageIndex
    
    pvcPostPageLoad curPage
    
    tbPage.SetFocus
    
  End If
  
End If



Exit Sub
fout:
If (Err = 2110) Then Resume Next 'focus problem
MsgBox Err & " pvbDisplayCurPage" & vbCrLf & Error$, 16
Exit Sub

End Sub


Private Function pvbAllowExitPage() As Boolean
On Error Resume Next
pvbAllowExitPage = pvcAllowExitPage(curPage)
End Function
Private Sub pvbUnloadPage()
On Error GoTo fout

Dim unloadPage As Integer
unloadPage = curPage

If (unloadPage <> -1) Then

  DoCmd.DoMenuItem A_FORMBAR, A_FILE, A_SAVERECORD, , A_MENU_VER20


  pvcPrePageUnload unloadPage
End If

'close the current page.

Me.subfrm.SourceObject = "WIZ_UNBOUND"
curPage = -1

Me.tabctl.Visible = False
Me.subfrm.Visible = True


If (unloadPage <> -1) Then
  pvcPostPageUnload unloadPage
End If

Exit Sub
fout:
MsgBox Err & " pvbUnloadPage" & vbCrLf & Error$, 16
Exit Sub
End Sub






Private Sub Form_Resize()
On Error GoTo fout

Dim newDetlHeight As Long

newDetlHeight = Me.Form.InsideHeight - Me.FormFooter.Height - Me.FormHeader.Height
If (newDetlHeight > Me.Detail.Height) Then
  Me.Detail.Height = newDetlHeight
  Me.subfrm.Height = Me.Detail.Height
  Me.tabctl.Height = Me.Detail.Height
Else
  Me.subfrm.Height = newDetlHeight
  Me.tabctl.Height = newDetlHeight
  Me.Detail.Height = newDetlHeight
End If

Dim newDetlWidth As Long
newDetlWidth = Me.Form.InsideWidth
Me.subfrm.Width = newDetlWidth
Me.tabctl.Width = newDetlWidth


Exit Sub
fout:
MsgBox Err & " form_resize" & vbCrLf & Error$, 16
Exit Sub

End Sub



Private Sub optView_AfterUpdate()
On Error Resume Next
  pvbMoveToPage optView.value
 
End Sub



Private Sub optView_BeforeUpdate(Cancel As Integer)
On Error Resume Next


If Not pvbAllowExitPage() Then
  Cancel = True
End If

End Sub



Private Sub Form_Current()
On Error Resume Next

pvbNotifyNewView


updateView

End Sub



Private Sub Form_Open(Cancel As Integer)
On Error Resume Next
setBackground Me

pvbInit

End Sub