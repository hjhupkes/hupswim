Version =20
VersionRequired =20
Checksum =-1463080071
Begin Form
    RecordSelectors = NotDefault
    MaxButton = NotDefault
    MinButton = NotDefault
    AutoCenter = NotDefault
    NavigationButtons = NotDefault
    ScrollBars =0
    GridX =5
    GridY =5
    Width =11338
    ItemSuffix =86
    Left =3690
    Top =300
    Right =16500
    Bottom =7545
    Toolbar ="gFrmToolbar"
    RecSrcDt = Begin
        0x4d2ff6f41874e140
    End
    Caption ="Ledenlijst"
    OnOpen ="[Event Procedure]"
    MenuBar ="gMnBasic"
    PrtMip = Begin
        0xa0050000a0050000a0050000a005000000000000201c0000e010000001000000 ,
        0x010000006801000000000000a10700000100000001000000
    End
    PrtDevMode = Begin
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x010402059c00c40253ef800101000100ea0a6f08640001000f00580202000100 ,
        0x5802030001004c65747465720000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000010000000000000001000000 ,
        0x0200000001000000000000000000000000000000000000000000000050524956 ,
        0xe230000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000180000000000102710271027 ,
        0x0000102700000000000000000000c40200000000000000000000000000000000 ,
        0x00000000000000000300000000000000000010005c4b03006843040000000000 ,
        0x000000000000010000000000000000000000000000000000e7b14b4c03000000 ,
        0x05000a00ff000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000
    End
    PrtDevNames = Begin
        0x080013001e000100000000000000000000000000000000000000000000005044 ,
        0x4643726561746f723a00
    End
    OnLoad ="[Event Procedure]"
    Begin
        Begin Label
            BackStyle =0
        End
        Begin CommandButton
            TextFontFamily =2
            Width =1701
            Height =283
        End
        Begin CheckBox
            SpecialEffect =2
            LabelX =230
            LabelY =-30
        End
        Begin OptionGroup
            Width =1701
            Height =1701
        End
        Begin TextBox
            Width =1701
            LabelX =-1701
        End
        Begin ListBox
            SpecialEffect =2
            Width =1701
            Height =1417
            LabelX =-1701
        End
        Begin ComboBox
            SpecialEffect =2
            Width =1701
            LabelX =-1701
        End
        Begin FormHeader
            Height =578
            BackColor =16776960
            Name ="FormHeader1"
            Begin
                Begin Label
                    BackStyle =1
                    OverlapFlags =85
                    TextAlign =2
                    Left =3968
                    Top =113
                    Width =2268
                    Height =340
                    FontSize =12
                    FontWeight =700
                    BackColor =65280
                    Name ="Text0"
                    Caption ="Ledenlijst"
                End
                Begin CommandButton
                    OverlapFlags =85
                    AccessKey =84
                    Left =9864
                    Top =113
                    Width =1245
                    Height =330
                    ForeColor =255
                    Name ="btnClose"
                    Caption ="&Terug"
                    OnClick ="[Event Procedure]"
                End
            End
        End
        Begin Section
            Height =5329
            BackColor =16776960
            Name ="Detail0"
            Begin
                Begin Label
                    BackStyle =1
                    OverlapFlags =93
                    Left =113
                    Top =226
                    Width =1125
                    Height =240
                    Name ="Text13"
                    Caption ="Kies rapport:"
                End
                Begin OptionGroup
                    OverlapFlags =223
                    Left =114
                    Top =450
                    Width =10881
                    Height =2153
                    BackColor =65280
                    Name ="optReport"
                    AfterUpdate ="[Event Procedure]"
                    DefaultValue ="1"
                    Begin
                        Begin OptionButton
                            OverlapFlags =87
                            AccessKey =68
                            Left =226
                            Top =584
                            OptionValue =1
                            Name ="Button19"
                            Begin
                                Begin Label
                                    BackStyle =1
                                    OverlapFlags =87
                                    Left =577
                                    Top =566
                                    Width =1635
                                    Height =240
                                    Name ="Text20"
                                    Caption ="Le&denlijst"
                                End
                            End
                        End
                        Begin OptionButton
                            OverlapFlags =87
                            AccessKey =69
                            Left =253
                            Top =1804
                            OptionValue =2
                            Name ="Option25"
                            Begin
                                Begin Label
                                    BackStyle =1
                                    OverlapFlags =87
                                    Left =597
                                    Top =1800
                                    Width =1020
                                    Height =240
                                    Name ="Label26"
                                    Caption ="&Enveloppen"
                                End
                            End
                        End
                        Begin OptionButton
                            OverlapFlags =87
                            AccessKey =75
                            Left =253
                            Top =2142
                            OptionValue =3
                            Name ="Option34"
                            Begin
                                Begin Label
                                    BackStyle =1
                                    OverlapFlags =87
                                    Left =597
                                    Top =2138
                                    Width =1020
                                    Height =240
                                    Name ="Label35"
                                    Caption ="Eti&ketten"
                                End
                            End
                        End
                    End
                End
                Begin CheckBox
                    SpecialEffect =0
                    OverlapFlags =215
                    Left =5215
                    Top =1387
                    TabIndex =1
                    Name ="blIncludeDates"
                    DefaultValue ="False"
                    Begin
                        Begin Label
                            OverlapFlags =247
                            Left =5441
                            Top =1360
                            Width =3060
                            Height =240
                            Name ="Label43"
                            Caption ="Geboorte, entree - en exit data opnemen"
                        End
                    End
                End
                Begin TextBox
                    OverlapFlags =85
                    TextAlign =1
                    Left =2721
                    Top =3175
                    Width =1011
                    TabIndex =3
                    Name ="fldGebStartDate"
                    Format ="dd-mm-yyyy"
                End
                Begin TextBox
                    OverlapFlags =85
                    TextAlign =1
                    Left =4309
                    Top =3175
                    Width =1011
                    TabIndex =4
                    Name ="fldGebEndDate"
                    Format ="dd-mm-yyyy"
                End
                Begin Label
                    OverlapFlags =85
                    Left =453
                    Top =3175
                    Width =2160
                    Height =210
                    Name ="Label55"
                    Caption ="Alleen geboorte data tussen"
                End
                Begin Label
                    OverlapFlags =85
                    Left =3855
                    Top =3175
                    Width =300
                    Height =210
                    Name ="Label56"
                    Caption ="en "
                End
                Begin CheckBox
                    SpecialEffect =0
                    OverlapFlags =215
                    Left =3061
                    Top =1397
                    TabIndex =5
                    Name ="blSortYear"
                    DefaultValue ="False"
                    Begin
                        Begin Label
                            OverlapFlags =247
                            Left =3293
                            Top =1360
                            Width =1605
                            Height =240
                            Name ="Label40"
                            Caption ="Sorteren per jaargang"
                        End
                    End
                End
                Begin TextBox
                    OverlapFlags =85
                    TextAlign =1
                    Left =8390
                    Top =3175
                    Width =456
                    TabIndex =6
                    Name ="fldStartMonth"
                    DefaultValue ="1"
                End
                Begin TextBox
                    OverlapFlags =85
                    TextAlign =1
                    Left =9411
                    Top =3175
                    Width =456
                    TabIndex =7
                    Name ="fldEndMonth"
                    DefaultValue ="12"
                End
                Begin Label
                    OverlapFlags =85
                    Left =6349
                    Top =3175
                    Width =1770
                    Height =210
                    Name ="Label49"
                    Caption ="Geboorte maand tussen"
                End
                Begin Label
                    OverlapFlags =85
                    Left =8957
                    Top =3175
                    Width =300
                    Height =210
                    Name ="Label51"
                    Caption ="en "
                End
                Begin CheckBox
                    SpecialEffect =0
                    OverlapFlags =215
                    Left =793
                    Top =1395
                    TabIndex =8
                    Name ="blSortVerjaardag"
                    DefaultValue ="False"
                    Begin
                        Begin Label
                            OverlapFlags =247
                            Left =1024
                            Top =1360
                            Width =1815
                            Height =240
                            Name ="Label58"
                            Caption ="Sorteren per verjaardag"
                        End
                    End
                End
                Begin CheckBox
                    SpecialEffect =0
                    OverlapFlags =215
                    Left =8617
                    Top =1387
                    TabIndex =2
                    Name ="blIncludeEmail"
                    DefaultValue ="False"
                    Begin
                        Begin Label
                            OverlapFlags =247
                            Left =8843
                            Top =1360
                            Width =1920
                            Height =240
                            Name ="Label62"
                            Caption ="Emailadressen opnemen"
                        End
                    End
                End
                Begin CheckBox
                    SpecialEffect =0
                    OverlapFlags =215
                    Left =793
                    Top =938
                    TabIndex =9
                    Name ="blGrpCat"
                    DefaultValue ="False"
                    GUID = Begin
                        0x1fed80329813184e96259136b6c8d922
                    End
                    Begin
                        Begin Label
                            OverlapFlags =247
                            Left =1016
                            Top =907
                            Width =1845
                            Height =240
                            Name ="Label64"
                            Caption ="Groeperen per categorie "
                            GUID = Begin
                                0x7dc9b60b567ddc448a9d6dcd4aced8e5
                            End
                        End
                    End
                End
                Begin CheckBox
                    SpecialEffect =0
                    OverlapFlags =215
                    Left =3061
                    Top =931
                    TabIndex =10
                    Name ="blGrpVer"
                    DefaultValue ="False"
                    GUID = Begin
                        0xf85a5fb95bbd4a41b06b3819d595728c
                    End
                    Begin
                        Begin Label
                            OverlapFlags =247
                            Left =3289
                            Top =907
                            Width =1875
                            Height =240
                            Name ="Label66"
                            Caption ="Groeperen per vereniging"
                            GUID = Begin
                                0xc7b7841d302a6b44a10e5359898ec342
                            End
                        End
                    End
                End
                Begin CheckBox
                    Enabled = NotDefault
                    SpecialEffect =0
                    OverlapFlags =85
                    Left =1701
                    Top =4901
                    TabIndex =11
                    Name ="blOnlyActive"
                    DefaultValue ="False"
                    GUID = Begin
                        0x759dfd779566a64bb25e77ddf22d6d60
                    End
                    Begin
                        Begin Label
                            OverlapFlags =247
                            Left =1938
                            Top =4878
                            Width =1005
                            Height =240
                            Name ="Label100"
                            Caption ="Alleen actief"
                            GUID = Begin
                                0xd9399e984080c84e9f5be6b145e62b25
                            End
                        End
                    End
                End
                Begin CommandButton
                    Enabled = NotDefault
                    OverlapFlags =85
                    AccessKey =76
                    TextFontFamily =34
                    Left =454
                    Top =4878
                    Width =1071
                    Height =330
                    FontSize =8
                    FontWeight =400
                    TabIndex =12
                    Name ="btnLS"
                    Caption ="&Lidsoorten"
                    OnClick ="[Event Procedure]"
                    FontName ="MS Sans Serif"
                    GUID = Begin
                        0xd4e4bee175f4db439ca151e327f8d87b
                    End
                End
                Begin CheckBox
                    SpecialEffect =0
                    OverlapFlags =85
                    Left =113
                    Top =4563
                    TabIndex =13
                    Name ="blRestrictLS"
                    AfterUpdate ="[Event Procedure]"
                    DefaultValue ="False"
                    GUID = Begin
                        0xe0dd9f48e557b84cabca7b4bc36ffd41
                    End
                    Begin
                        Begin Label
                            BackStyle =1
                            OverlapFlags =247
                            Left =345
                            Top =4535
                            Width =2625
                            Height =240
                            Name ="Label69"
                            Caption ="Beperking opleggen aan leden"
                            GUID = Begin
                                0x500ec9d395741744a00d355001d936d7
                            End
                        End
                    End
                End
                Begin CheckBox
                    SpecialEffect =0
                    OverlapFlags =85
                    Left =113
                    Top =2867
                    TabIndex =14
                    Name ="blRestrictGebDatum"
                    AfterUpdate ="[Event Procedure]"
                    DefaultValue ="False"
                    GUID = Begin
                        0xd0f1a030bfc19b4f8f5559c0293f6c5c
                    End
                    Begin
                        Begin Label
                            BackStyle =1
                            OverlapFlags =247
                            Left =345
                            Top =2834
                            Width =1890
                            Height =240
                            Name ="Label71"
                            Caption ="Geboortedatum beperken"
                            GUID = Begin
                                0xec09cfec24471a4eb5370054379da0f4
                            End
                        End
                    End
                End
                Begin CheckBox
                    SpecialEffect =0
                    OverlapFlags =85
                    Left =113
                    Top =3665
                    TabIndex =15
                    Name ="blRestrictEntryDate"
                    AfterUpdate ="[Event Procedure]"
                    DefaultValue ="False"
                    GUID = Begin
                        0x82a411f4d9c8d148890e40d875929027
                    End
                    Begin
                        Begin Label
                            BackStyle =1
                            OverlapFlags =247
                            Left =345
                            Top =3628
                            Width =1740
                            Height =240
                            Name ="Label73"
                            Caption ="Entree datum beperken"
                            GUID = Begin
                                0xc1e8279064534c418fa4aaf8aa945d41
                            End
                        End
                    End
                End
                Begin CheckBox
                    SpecialEffect =0
                    OverlapFlags =85
                    Left =6009
                    Top =3697
                    TabIndex =16
                    Name ="blRestrictExitDate"
                    AfterUpdate ="[Event Procedure]"
                    DefaultValue ="False"
                    GUID = Begin
                        0x33a9397727701e458cf6d1e1ece3c4ec
                    End
                    Begin
                        Begin Label
                            BackStyle =1
                            OverlapFlags =247
                            Left =6241
                            Top =3665
                            Width =1530
                            Height =240
                            Name ="Label75"
                            Caption ="Exit datum beperken"
                            GUID = Begin
                                0x88f0e65914da4b479bb7828ae10d2975
                            End
                        End
                    End
                End
                Begin CheckBox
                    SpecialEffect =0
                    OverlapFlags =85
                    Left =6009
                    Top =2861
                    TabIndex =17
                    Name ="blRestrictGebMonth"
                    AfterUpdate ="[Event Procedure]"
                    DefaultValue ="False"
                    GUID = Begin
                        0xc62004ee29746e44b28425bef954ab17
                    End
                    Begin
                        Begin Label
                            BackStyle =1
                            OverlapFlags =247
                            Left =6241
                            Top =2834
                            Width =1980
                            Height =240
                            Name ="Label77"
                            Caption ="Geboorte maand beperken"
                            GUID = Begin
                                0xc67991341adfb84688f40848f37d1ab4
                            End
                        End
                    End
                End
                Begin TextBox
                    OverlapFlags =85
                    TextAlign =1
                    Left =2721
                    Top =4005
                    Width =1011
                    TabIndex =18
                    Name ="fldEntryStartDate"
                    Format ="dd-mm-yyyy"
                    GUID = Begin
                        0xad19e23cd7d806499b0ec27160e237ce
                    End
                End
                Begin TextBox
                    OverlapFlags =85
                    TextAlign =1
                    Left =4309
                    Top =4005
                    Width =1011
                    TabIndex =19
                    Name ="fldEntryEndDate"
                    Format ="dd-mm-yyyy"
                    GUID = Begin
                        0xbd91d870f7551a4fa4ebe914b46b7b87
                    End
                End
                Begin Label
                    OverlapFlags =85
                    Left =453
                    Top =4005
                    Width =1875
                    Height =210
                    Name ="Label80"
                    Caption ="Alleen entree data tussen"
                    GUID = Begin
                        0xcd80bf9e7cb54f4a85f6d52d5022e031
                    End
                End
                Begin Label
                    OverlapFlags =85
                    Left =3855
                    Top =4005
                    Width =300
                    Height =210
                    Name ="Label81"
                    Caption ="en "
                    GUID = Begin
                        0x1bcc2ab02f38b147bbf7f3a841a08ec1
                    End
                End
                Begin TextBox
                    OverlapFlags =85
                    TextAlign =1
                    Left =8390
                    Top =4005
                    Width =1011
                    TabIndex =20
                    Name ="fldExitStartDate"
                    Format ="dd-mm-yyyy"
                    GUID = Begin
                        0xf9ed3fe75156e04c85e685e17b00fde9
                    End
                End
                Begin TextBox
                    OverlapFlags =85
                    TextAlign =1
                    Left =9978
                    Top =4005
                    Width =1011
                    TabIndex =21
                    Name ="fldExitEndDate"
                    Format ="dd-mm-yyyy"
                    GUID = Begin
                        0x0f29ca65d1ea9f478b4c38454097eec3
                    End
                End
                Begin Label
                    OverlapFlags =85
                    Left =6349
                    Top =4005
                    Width =1710
                    Height =210
                    Name ="Label84"
                    Caption ="Alleen exit data tussen"
                    GUID = Begin
                        0x8197e6272a5bef428cc7f1e41e305600
                    End
                End
                Begin Label
                    OverlapFlags =85
                    Left =9524
                    Top =4005
                    Width =300
                    Height =210
                    Name ="Label85"
                    Caption ="en "
                    GUID = Begin
                        0x8f5e99a02f81d24d80d2e3e7c52b21e2
                    End
                End
                Begin CommandButton
                    OverlapFlags =85
                    Left =4650
                    Top =4845
                    Height =358
                    TabIndex =22
                    Name ="btnMailMerge"
                    Caption ="-> Mail Merge"
                    OnClick ="[Event Procedure]"
                    GUID = Begin
                        0xc7b619a4ecd05940a6c677ec7aeea85d
                    End
                End
                Begin Label
                    OverlapFlags =85
                    Left =6420
                    Top =4905
                    Width =4785
                    Height =210
                    Name ="Label72"
                    Caption ="(Emails versturen, diverse soorten etiketten en enveloppen printen)"
                    GUID = Begin
                        0x056173ef8409724e8b9fef56dcfcf7dd
                    End
                End
            End
        End
        Begin FormFooter
            Height =566
            BackColor =16776960
            Name ="FormFooter2"
            Begin
                Begin CommandButton
                    OverlapFlags =85
                    AccessKey =66
                    Left =113
                    Top =113
                    Width =1060
                    Height =378
                    Name ="btnbekijken"
                    Caption ="&Bekijken"
                    OnClick ="[Event Procedure]"
                    GUID = Begin
                        0x129cddc82923414f882ad9dbf46c807b
                    End
                End
                Begin CommandButton
                    OverlapFlags =85
                    AccessKey =80
                    Left =1986
                    Top =113
                    Width =925
                    Height =378
                    TabIndex =1
                    Name ="btnprinten"
                    Caption ="&Printen"
                    OnClick ="[Event Procedure]"
                    GUID = Begin
                        0x392e83e905bae642a23fb46988f17325
                    End
                End
                Begin CommandButton
                    OverlapFlags =85
                    Left =3083
                    Top =113
                    Width =1030
                    Height =378
                    TabIndex =2
                    Name ="btnRTF"
                    Caption ="Exp RTF"
                    OnClick ="[Event Procedure]"
                    GUID = Begin
                        0xecdb841108bcbd4686219a1124df8e6a
                    End
                End
                Begin CommandButton
                    OverlapFlags =85
                    Left =4163
                    Top =113
                    Width =1030
                    Height =378
                    TabIndex =3
                    Name ="btnTXT"
                    Caption ="Exp TXT"
                    OnClick ="[Event Procedure]"
                    GUID = Begin
                        0x8b5f5e2449bfcb49b0a5b932f7c12a9c
                    End
                End
                Begin CommandButton
                    OverlapFlags =85
                    Left =5243
                    Top =113
                    Width =1030
                    Height =378
                    TabIndex =4
                    Name ="btnXLS"
                    Caption ="Exp XLS"
                    OnClick ="[Event Procedure]"
                    GUID = Begin
                        0x94f4fdfc633bfa49ace056e4f6810c11
                    End
                End
                Begin CommandButton
                    OverlapFlags =85
                    Left =6323
                    Top =113
                    Width =1150
                    Height =378
                    TabIndex =5
                    Name ="btnHTML"
                    Caption ="Exp HTML"
                    OnClick ="[Event Procedure]"
                    GUID = Begin
                        0x1820e9a1b44e474ba8e6bffc324d5326
                    End
                End
                Begin CommandButton
                    OverlapFlags =85
                    Left =7508
                    Top =113
                    Width =1030
                    Height =378
                    TabIndex =6
                    Name ="btnXML"
                    Caption ="Exp XML"
                    OnClick ="[Event Procedure]"
                    GUID = Begin
                        0x237c9fa4f6e33748847994b763473d60
                    End
                End
                Begin TextBox
                    OverlapFlags =85
                    Left =1268
                    Top =185
                    Width =321
                    TabIndex =7
                    Name ="fldNEx"
                    DefaultValue ="1"
                    GUID = Begin
                        0x6a3c7baddc77e544a82d315fa304f8d4
                    End
                    Begin
                        Begin Label
                            OverlapFlags =85
                            Left =1627
                            Top =185
                            Width =315
                            Height =240
                            Name ="Label363"
                            Caption ="ex."
                            GUID = Begin
                                0xce2c9d9f31758740b9cf2ffe3433dc39
                            End
                        End
                    End
                End
                Begin CommandButton
                    OverlapFlags =85
                    Left =8583
                    Top =113
                    Width =985
                    Height =378
                    TabIndex =8
                    Name ="btnPDF"
                    Caption ="Exp PDF"
                    OnClick ="[Event Procedure]"
                    GUID = Begin
                        0x79d6267e91e12747b1ef54b2a8582f44
                    End
                End
                Begin CommandButton
                    OverlapFlags =85
                    Left =9626
                    Top =113
                    Width =1165
                    Height =378
                    TabIndex =9
                    Name ="btnRTFX"
                    Caption ="Exp RTF-X"
                    OnClick ="[Event Procedure]"
                    GUID = Begin
                        0x5de9bc4dc265ca4b99fee0869a4c2d0f
                    End
                End
            End
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False

Option Compare Database   'Use database order for string comparisons
Option Explicit

Private Const OPT_LIST = 1
Private Const OPT_LAB = 3
Private Const OPT_ENV = 2




Private lsCode As Integer




Private Function getChoice() As Integer
On Error Resume Next
getChoice = Nz(Me.optReport)
End Function

Private Sub updateView()
On Error Resume Next
Dim chc As Integer
chc = getChoice

Me.fldGebStartDate.Enabled = Nz(Me.blRestrictGebDatum)
Me.fldGebEndDate.Enabled = Nz(Me.blRestrictGebDatum)

Me.fldStartMonth.Enabled = Nz(Me.blRestrictGebMonth)
Me.fldEndMonth.Enabled = Nz(Me.blRestrictGebMonth)

Me.fldEntryStartDate.Enabled = Nz(Me.blRestrictEntryDate)
Me.fldEntryEndDate.Enabled = Nz(Me.blRestrictEntryDate)

Me.fldExitStartDate.Enabled = Nz(Me.blRestrictExitDate)
Me.fldExitEndDate.Enabled = Nz(Me.blRestrictExitDate)

Me.blGrpCat.Enabled = (chc = OPT_LIST)

If (dbIsMultipleVer()) Then
  Me.blGrpVer.Visible = True
  Me.blGrpVer.Enabled = (chc = OPT_LIST)
Else
  Me.blGrpVer.Visible = False
End If

Me.blSortVerjaardag.Enabled = (chc = OPT_LIST)
Me.blSortYear.Enabled = (chc = OPT_LIST)
Me.blIncludeDates.Enabled = (chc = OPT_LIST)
Me.blIncludeEmail.Enabled = (chc = OPT_LIST)

Me.btnLS.Enabled = Nz(Me.blRestrictLS)
Me.blOnlyActive.Enabled = Nz(Me.blRestrictLS)

End Sub



Private Sub blRestrictEntryDate_AfterUpdate()
On Error Resume Next
updateView
End Sub

Private Sub blRestrictExitDate_AfterUpdate()
On Error Resume Next
updateView
End Sub

Private Sub blRestrictGebDatum_AfterUpdate()
On Error Resume Next
updateView
End Sub

Private Sub blRestrictGebMonth_AfterUpdate()
On Error Resume Next
updateView
End Sub

Private Sub blRestrictLS_AfterUpdate()
On Error Resume Next
updateView
End Sub






Private Sub btnClose_Click()
On Error Resume Next
DoCmd.Close
End Sub

Private Sub btnLS_Click()
On Error Resume Next
Dim isOK As Boolean, lkpCode As Long

If Not lsPromptUser(True, lsCode, isOK, lkpCode) Then
  Exit Sub
End If

If (isOK) Then
  lsCode = lkpCode
End If

End Sub









Private Sub btnBekijken_Click()
On Error Resume Next
handleView RPT_MODE_PREVIEW, 0, -1
End Sub

Private Sub btnMailMerge_Click()
On Error Resume Next
Dim sDummy As String
If Not prepareView(OPT_LAB, sDummy) Then
  Exit Sub
End If

DoCmd.OpenForm "gMM_Master"
End Sub


Private Sub btnPrinten_Click()
On Error Resume Next
handleView RPT_MODE_PRINT, Nz(Me.fldNEx), -1
End Sub

Private Sub btnRTF_Click()
On Error Resume Next
handleView RPT_MODE_EXPORT, 0, RXP_FORMAT_RTF
End Sub
Private Sub btnTXT_Click()
On Error Resume Next
handleView RPT_MODE_EXPORT, 0, RXP_FORMAT_TXT
End Sub



Private Sub btnXLS_Click()
On Error Resume Next
handleView RPT_MODE_EXPORT, 0, RXP_FORMAT_XLS
End Sub
Private Sub btnHTML_Click()
On Error Resume Next
handleView RPT_MODE_EXPORT, 0, RXP_FORMAT_HTM
End Sub
Private Sub btnXML_Click()
On Error Resume Next
handleView RPT_MODE_EXPORT, 0, RXP_FORMAT_XML
End Sub

Private Sub btnPDF_Click()
On Error Resume Next
handleView RPT_MODE_EXPORT, 0, RXP_FORMAT_PDF
End Sub

Private Sub btnRTFX_Click()
On Error Resume Next
handleView RPT_MODE_EXPORT, 0, RXP_FORMAT_RTF_X
End Sub







Private Sub Form_Load()
On Error Resume Next
updateView
End Sub



Private Sub Form_Open(Cancel As Integer)
On Error Resume Next
setBackground Me
End Sub

Private Sub optReport_AfterUpdate()
On Error Resume Next
updateView
End Sub


Private Function prepareView(ByVal chc As Integer, ByRef rptName As String) As Boolean
On Error GoTo fout
prepareView = False



Dim optGrpCat As Boolean, optGrpVer As Boolean
Dim optSortVerjaardag As Boolean, optSortYear As Boolean
Dim optIncludeDate As Boolean, optIncludeEmail As Boolean

Dim optRestrictGebDate As Boolean, optRestrictGebMonth As Boolean
Dim optRestrictEntryDate As Boolean, optRestrictExitDate As Boolean

Dim dGebStartDate As Date, dGebEndDate As Date
Dim dEntryStartDate As Date, dEntryEndDate As Date
Dim dExitStartDate As Date, dExitEndDate As Date
Dim lStartMonth As Long, lEndMonth As Long

Dim optRestrictLS As Boolean, optOnlyActive As Boolean

optGrpCat = Nz(Me.blGrpCat)
optGrpVer = Nz(Me.blGrpVer)
optSortVerjaardag = Nz(Me.blSortVerjaardag)
optSortYear = Nz(Me.blSortYear)
optIncludeDate = Nz(Me.blIncludeDates)
optIncludeEmail = Nz(Me.blIncludeEmail)

optRestrictGebDate = Nz(Me.blRestrictGebDatum)
optRestrictGebMonth = Nz(Me.blRestrictGebMonth)
optRestrictEntryDate = Nz(Me.blRestrictEntryDate)
optRestrictExitDate = Nz(Me.blRestrictExitDate)

dGebStartDate = Nz(Me.fldGebStartDate)
dGebEndDate = Nz(Me.fldGebEndDate)

dEntryStartDate = Nz(Me.fldEntryStartDate)
dEntryEndDate = Nz(Me.fldEntryEndDate)

dExitStartDate = Nz(Me.fldExitStartDate)
dExitEndDate = Nz(Me.fldExitEndDate)

lStartMonth = Nz(Me.fldStartMonth)
lEndMonth = Nz(Me.fldEndMonth)

optRestrictLS = Nz(Me.blRestrictLS)
optOnlyActive = Nz(Me.blOnlyActive)



Select Case chc
  Case OPT_LIST
  
    If Not swmBuildList(optGrpCat, optRestrictLS, lsCode, optOnlyActive, _
      optRestrictEntryDate, dEntryStartDate, dEntryEndDate, _
      optRestrictExitDate, dExitStartDate, dExitEndDate, _
      optRestrictGebDate, dGebStartDate, dGebEndDate, _
      optRestrictGebMonth, lStartMonth, lEndMonth, _
      False, "") Then
    
      Exit Function
    End If
  
    
    'Now prepare the report
    rptName = REP_SWM_LIST
    
    If Not rxpSetSwmListOptions(optSortVerjaardag, optSortYear, optIncludeDate, optIncludeEmail) Then
      Exit Function
    End If
    
    
  Case OPT_ENV, OPT_LAB
    If Not swmBuildList(False, optRestrictLS, lsCode, optOnlyActive, _
      optRestrictEntryDate, dEntryStartDate, dEntryEndDate, _
      optRestrictExitDate, dExitStartDate, dExitEndDate, _
      optRestrictGebDate, dGebStartDate, dGebEndDate, _
      optRestrictGebMonth, lStartMonth, lEndMonth, _
      False, "") Then
    
      Exit Function
    End If
    
    'Still need to build labels.
    
    If Not swmListToMailMerge() Then
      Exit Function
    End If
    If (chc = OPT_LAB) Then
      rptName = REP_MM_LAB
    Else
      rptName = REP_MM_ENV
    End If
  
End Select



prepareView = True
Exit Function

fout:
MsgBox Err & " prepareView" & vbCrLf & Error$, 16
Exit Function

End Function

Private Sub handleView(ByVal rptOpenMode As Integer, ByVal rptNCopies As Integer, ByVal rxpFormat As Integer)
On Error GoTo fout


Dim chc As Integer
chc = getChoice


Dim rptName As String

If Not prepareView(chc, rptName) Then
  Exit Sub
End If


Dim vDummy(0 To 0) As Variant

If Not rptHandle(False, rptName, rptOpenMode, rptNCopies, rxpFormat, 0, vDummy) Then
  Exit Sub
End If


Exit Sub
fout:
MsgBox Err & " handleView" & vbCrLf & Error$, 16
Exit Sub

'debug
On Error GoTo 0
Resume Next
End Sub